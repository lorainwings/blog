<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack æºç æµç¨‹åˆ†æ | Lorain&#39;s Diary</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/base/hd-img.jpg">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/base/hd-img.jpg">
    <meta name="description" content="å±±ä¸­æ¨—æ å¹´å¹´åœ¨ & çœ‹å°½è¥¿é£æœ¨æ§¿èŠ±">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/blog/assets/css/0.styles.4a9580f2.css" as="style"><link rel="preload" href="/blog/assets/js/app.7c77a4cc.js" as="script"><link rel="preload" href="/blog/assets/js/3.8c44ca0e.js" as="script"><link rel="preload" href="/blog/assets/js/38.1696d6ea.js" as="script"><link rel="preload" href="/blog/assets/js/4.57980df9.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.930d1339.js"><link rel="prefetch" href="/blog/assets/js/11.cdeb8098.js"><link rel="prefetch" href="/blog/assets/js/12.12800b1d.js"><link rel="prefetch" href="/blog/assets/js/13.320dc92e.js"><link rel="prefetch" href="/blog/assets/js/14.1f75dcec.js"><link rel="prefetch" href="/blog/assets/js/15.6e02fab8.js"><link rel="prefetch" href="/blog/assets/js/16.87b6dc9c.js"><link rel="prefetch" href="/blog/assets/js/17.b00c4839.js"><link rel="prefetch" href="/blog/assets/js/18.1cf792a3.js"><link rel="prefetch" href="/blog/assets/js/19.cb4e044a.js"><link rel="prefetch" href="/blog/assets/js/20.542d38de.js"><link rel="prefetch" href="/blog/assets/js/21.91f8ffeb.js"><link rel="prefetch" href="/blog/assets/js/22.f566dc38.js"><link rel="prefetch" href="/blog/assets/js/23.b69d67c8.js"><link rel="prefetch" href="/blog/assets/js/24.77fc48a4.js"><link rel="prefetch" href="/blog/assets/js/25.31cd7e03.js"><link rel="prefetch" href="/blog/assets/js/26.e8823c82.js"><link rel="prefetch" href="/blog/assets/js/27.a7430202.js"><link rel="prefetch" href="/blog/assets/js/28.d8ebaaa5.js"><link rel="prefetch" href="/blog/assets/js/29.4c8e906e.js"><link rel="prefetch" href="/blog/assets/js/30.5650d64c.js"><link rel="prefetch" href="/blog/assets/js/31.cc7dc388.js"><link rel="prefetch" href="/blog/assets/js/32.ea170940.js"><link rel="prefetch" href="/blog/assets/js/33.deffdf15.js"><link rel="prefetch" href="/blog/assets/js/34.dc1a5e46.js"><link rel="prefetch" href="/blog/assets/js/35.6a4b0a17.js"><link rel="prefetch" href="/blog/assets/js/36.2f471bfa.js"><link rel="prefetch" href="/blog/assets/js/37.f89b6c31.js"><link rel="prefetch" href="/blog/assets/js/39.8ba92439.js"><link rel="prefetch" href="/blog/assets/js/40.3e0a8f49.js"><link rel="prefetch" href="/blog/assets/js/41.55113ca5.js"><link rel="prefetch" href="/blog/assets/js/42.08e02830.js"><link rel="prefetch" href="/blog/assets/js/43.94613343.js"><link rel="prefetch" href="/blog/assets/js/44.56192766.js"><link rel="prefetch" href="/blog/assets/js/45.9c693d8a.js"><link rel="prefetch" href="/blog/assets/js/46.03a26959.js"><link rel="prefetch" href="/blog/assets/js/47.b29d5306.js"><link rel="prefetch" href="/blog/assets/js/48.cd893ec3.js"><link rel="prefetch" href="/blog/assets/js/49.12210cfc.js"><link rel="prefetch" href="/blog/assets/js/5.5d055cab.js"><link rel="prefetch" href="/blog/assets/js/50.ddcb3929.js"><link rel="prefetch" href="/blog/assets/js/51.8b677dba.js"><link rel="prefetch" href="/blog/assets/js/52.73a630cf.js"><link rel="prefetch" href="/blog/assets/js/53.989d0b51.js"><link rel="prefetch" href="/blog/assets/js/6.5cf5829a.js"><link rel="prefetch" href="/blog/assets/js/7.46c43574.js"><link rel="prefetch" href="/blog/assets/js/8.97b71141.js"><link rel="prefetch" href="/blog/assets/js/9.5a3cc726.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.8f04fa7f.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.4a9580f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Lorain's Diary</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  ğŸ“œå‰ç«¯æŠ€æœ¯
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  ğŸ“Šè®¡ç®—æœºåŸºç¡€
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  ğŸ€å…¶ä»–è®°å½•
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  â­ï¸Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  ğŸ“œå‰ç«¯æŠ€æœ¯
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  ğŸ“Šè®¡ç®—æœºåŸºç¡€
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  ğŸ€å…¶ä»–è®°å½•
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  â­ï¸Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JSè¯­è¨€åŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5åŠæ¡†æ¶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/Babelæ‚è°ˆ.html" class="sidebar-link">Babel æ‚è°ˆ</a></li><li><a href="/blog/skills/ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°.html" class="sidebar-link">ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°</a></li><li><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html" class="sidebar-link">Webpack åŸºç¡€çŸ¥è¯†</a></li><li><a href="/blog/skills/Webpackæ¨¡å—å®ç°.html" class="sidebar-link">Webpack æ¨¡å—å®ç°</a></li><li><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html" class="sidebar-link">Webpack å¼‚æ­¥åŠ è½½</a></li><li><a href="/blog/skills/Webpackæºç æµç¨‹åˆ†æ.html" class="active sidebar-link">Webpack æºç æµç¨‹åˆ†æ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/Webpackæºç æµç¨‹åˆ†æ.html#ä»å‘½ä»¤è¡Œå¼€å§‹" class="sidebar-link">ä»å‘½ä»¤è¡Œå¼€å§‹</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackæºç æµç¨‹åˆ†æ.html#å‘½ä»¤æ‰§è¡Œå…¥å£" class="sidebar-link">å‘½ä»¤æ‰§è¡Œå…¥å£</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackæºç æµç¨‹åˆ†æ.html#webpack-æºç å…¥å£åˆ†æ" class="sidebar-link">Webpack æºç å…¥å£åˆ†æ</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackæºç æµç¨‹åˆ†æ.html#æ‰§è¡Œ-webpack-cli" class="sidebar-link">æ‰§è¡Œ webpack-cli</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackæºç æµç¨‹åˆ†æ.html#tapable" class="sidebar-link">Tapable</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®‰å…¨åŠæ€§èƒ½ä¼˜åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æœåŠ¡ç«¯å…¥é—¨</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-æºç æµç¨‹åˆ†æ"><a href="#webpack-æºç æµç¨‹åˆ†æ" class="header-anchor">#</a> Webpack æºç æµç¨‹åˆ†æ</h1> <p>æœ¬æ–‡æ¥åˆ†æä¸€ä¸‹å‰ç«¯æœ€æµè¡Œçš„æ„å»ºå·¥å…·<code>webpack</code>çš„æºç æµç¨‹, ä»¥ä¾¿åŠ æ·±è‡ªå·±å¯¹<code>webpack</code>çš„ç†è§£</p> <h2 id="ä»å‘½ä»¤è¡Œå¼€å§‹"><a href="#ä»å‘½ä»¤è¡Œå¼€å§‹" class="header-anchor">#</a> ä»å‘½ä»¤è¡Œå¼€å§‹</h2> <div class="language-sh extra-class"><pre class="language-sh"><code>webpack entry.js bundle.js

<span class="token comment"># æˆ–</span>

<span class="token function">npm</span> run <span class="token punctuation">(</span>build/dev<span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘ä»¬ç›´æ¥æ‰§è¡Œè¯¥å‘½ä»¤, é‚£ä¹ˆ<code>webpack</code>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­åšäº†ä»€ä¹ˆæ“ä½œå‘¢?</p> <h2 id="å‘½ä»¤æ‰§è¡Œå…¥å£"><a href="#å‘½ä»¤æ‰§è¡Œå…¥å£" class="header-anchor">#</a> å‘½ä»¤æ‰§è¡Œå…¥å£</h2> <p>npm ä¼šè®©å‘½ä»¤è¡Œå·¥å…·è¿›å…¥ <code>node_modules/bin</code>ç›®å½•æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨<code>webpack.sh</code>æˆ–è€…<code>webpack.cmd</code>, å­˜åœ¨å°±æ‰§è¡Œ, å¦åˆ™æŠ›å‡ºé”™è¯¯</p> <p><code>node_modules/bin/webpack</code> æ˜¯ <code>node_modules/webpack/bin/webpack.js</code>çš„ä¸€ä¸ªæ˜ å°„ link</p> <p>é‚£ä¹ˆ, webpack å®é™…çš„æ‰§è¡Œå…¥å£æ˜¯<code>node_modules/webpack/bin/webpack.js</code></p> <h2 id="webpack-æºç å…¥å£åˆ†æ"><a href="#webpack-æºç å…¥å£åˆ†æ" class="header-anchor">#</a> Webpack æºç å…¥å£åˆ†æ</h2> <p>é€šè¿‡ç»“æ„åˆ†æ, å¯ä»¥å°†è¯¥æºç æ‹†åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ¨¡å—</p> <p><img src="/blog/skills/images/webpack-source-frame.png" alt="webpackå…¥å£æ–‡ä»¶ç»“æ„"></p> <p>ä¸»è¦é€»è¾‘æ˜¯, å½“å‘½ä»¤å¼€å§‹æ‰§è¡Œæ—¶, åˆ¤æ–­æ˜¯å¦å®‰è£…<code>webpack-cli</code>æˆ–è€…<code>webpack-command</code> ?</p> <p>å¦‚æœæ²¡æœ‰å®‰è£…å°†æç¤ºç”¨æˆ·å®‰è£…, ä¸ç”¨æˆ·äº¤äº’å, ç”¨æˆ·åŒæ„å®‰è£…åˆ™è‡ªåŠ¨å¸®ç”¨æˆ·å®‰è£…å¥½</p> <p>å¦‚æœå·²ç»å®‰è£…ä¸”åªå®‰è£…äº†ä¸€ä¸ª<code>cli</code>, ä½¿ç”¨<code>require.resolve</code>æ¥è¯»å–<code>cli</code>çš„ä½ç½®, å¹¶åŠ è½½</p> <p>å¦‚æœå®‰è£…äº† 2 ä¸ª<code>cli</code>, æŠ›å‡ºé”™è¯¯<code>To work with the &quot;webpack&quot; command you need only one CLI package, please remove one of them or use them directly via their binary.</code></p> <p>æœ€ç»ˆçš„ç»“æœ: <code>webpack</code>æ‰¾åˆ°<code>webpack-cli</code>æˆ–è€…<code>webpack-command</code>è¿™ä¸ª npm åŒ…, å¹¶ä¸”æ‰§è¡Œ cli</p> <h2 id="æ‰§è¡Œ-webpack-cli"><a href="#æ‰§è¡Œ-webpack-cli" class="header-anchor">#</a> æ‰§è¡Œ webpack-cli</h2> <p><img src="/blog/skills/images/webpack-non-compiler.png" alt="webpack-cli"></p> <ul><li>å¼•å…¥<code>yargs</code>, å¯¹å‘½ä»¤è¡Œè¿›è¡Œå®šåˆ¶</li> <li>åˆ†æå‘½ä»¤è¡Œå‚æ•°, å¯¹å„ä¸ªå‚æ•°è¿›è¡Œè½¬æ¢, ç»„æˆç¼–è¯‘é…ç½®é¡¹</li> <li>å¼•ç”¨<code>webpack</code>, æ ¹æ®é…ç½®é¡¹è¿›è¡Œç¼–è¯‘å’Œæ„å»º</li></ul> <p><code>webpack-cli</code>ä½¿ç”¨ args åˆ†æ</p> <p><img src="/blog/skills/images/webpack-cli-args.png" alt="webpack-cli-args"></p> <p><code>webpack-cli</code>å¯¹é…ç½®æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°è¿›è¡Œè½¬æ¢æœ€ç»ˆç”Ÿæˆé…ç½®é€‰é¡¹å‚æ•° options</p> <p>æœ€ç»ˆä¼šæ ¹æ®é…ç½®å‚æ•°å®ä¾‹åŒ– webpack å¯¹è±¡,ç„¶åæ‰§è¡Œæ„å»ºæµç¨‹</p> <h2 id="tapable"><a href="#tapable" class="header-anchor">#</a> Tapable</h2> <p><code>Webpack</code> å¯ä»¥å°†å…¶ç†è§£æ˜¯ä¸€ç§åŸºäºäº‹ä»¶æµçš„ç¼–ç¨‹èŒƒä¾‹, ä¸€ç³»åˆ—çš„æ’ä»¶è¿è¡Œ</p> <h3 id="ä»€ä¹ˆæ˜¯-tapable"><a href="#ä»€ä¹ˆæ˜¯-tapable" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯ Tapable</h3> <p><code>Tapable</code>æ˜¯ä¸€ç§ç±»ä¼¼äº Node.js çš„<code>EventEmitter</code>çš„åº“, ä¸»è¦æ˜¯æ§åˆ¶é’©å­å‡½æ•°çš„å‘å¸ƒä¸è®¢é˜…,æ§åˆ¶ç€ webpack çš„æ’ä»¶ç³»ç»Ÿ</p> <h3 id="tapable-hooks"><a href="#tapable-hooks" class="header-anchor">#</a> Tapable Hooks</h3> <p><img src="/blog/skills/images/tapable-hooks.png" alt="tapable-hooks"></p> <p><code>Tapable Hooks</code>çš„ç±»å‹:</p> <p><img src="/blog/skills/images/tapable-hooks-type.png" alt="tapable-hooks-type"></p> <ul><li><p><code>Bail</code>æ˜¯ä¿é™©çš„æ„æ€(ç†”æ–­)</p></li> <li><p><code>Waterfall</code>æ˜¯ç€‘å¸ƒçš„æ„æ€(ä¸Šä¸€ä¸ªç»“æœä¼ ç»™ä¸‹ä¸€ä¸ª)</p></li> <li><p><code>Loop</code>æ˜¯å¾ªç¯çš„æ„æ€(è¿”å› <code>true</code> ä¼šç»§ç»­å¾ªç¯å½“å‰)</p></li></ul> <h3 id="tapable-çš„ä½¿ç”¨"><a href="#tapable-çš„ä½¿ç”¨" class="header-anchor">#</a> Tapable çš„ä½¿ç”¨</h3> <p><code>Tapable</code>æš´éœ²å‡ºæ¥çš„éƒ½æ˜¯ç±»æ–¹æ³•, new ä¸€ä¸ªç±»æ–¹æ³•è·å–æˆ‘ä»¬éœ€è¦çš„é’©å­</p> <p>class æ¥å—æ•°ç»„å‚æ•° options, éå¿…ä¼ ã€‚ç±»æ–¹æ³•ä¼šæ ¹æ®ä¼ å‚ï¼Œ æ¥å—åŒæ ·æ•°é‡çš„å‚æ•°</p> <h4 id="åŒæ­¥é’©å­"><a href="#åŒæ­¥é’©å­" class="header-anchor">#</a> åŒæ­¥é’©å­</h4> <p><code>hooks</code> çš„åŒæ­¥æ³¨å†Œæ–¹å¼ä½¿ç”¨<code>tap</code>, è°ƒç”¨åŒæ­¥é’©å­æ–¹æ³•ä½¿ç”¨<code>call</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> SyncHook <span class="token punctuation">}</span>  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tapable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">TestSync</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      arch<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„, è¡¨ç¤ºå‚æ•°ä¸ªæ•°</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è®¢é˜…</span>
  <span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//å‘å¸ƒ</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">arch</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="å¼‚æ­¥é’©å­"><a href="#å¼‚æ­¥é’©å­" class="header-anchor">#</a> å¼‚æ­¥é’©å­</h4> <p><code>hooks</code> çš„å¼‚æ­¥æ³¨å†Œæ–¹å¼ä½¿ç”¨<code>tapAsync</code>æˆ–è€…<code>tapPromise</code>, è°ƒç”¨å¼‚æ­¥é’©å­æ–¹å¼ä½¿ç”¨<code>callAsync</code>æˆ–è€…<code>promise</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¼‚æ­¥å¹¶å‘é’©å­</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> AsyncParallelHook <span class="token punctuation">}</span>  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tapable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">TestAsync</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      arch<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">AsyncParallelHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„, è¡¨ç¤ºå‚æ•°ä¸ªæ•°</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è®¢é˜…</span>
  <span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯¥æ¬¡å¼‚æ­¥æ‰§è¡Œå®Œæˆ</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
       <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯¥æ¬¡å¼‚æ­¥æ‰§è¡Œå®Œæˆ</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//å‘å¸ƒ</span>
  <span class="token function">startAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">callAsync</span><span class="token punctuation">(</span><span class="token string">'args'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é’©å­æ‰§è¡Œå®Œæˆ'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">TestAsyncPromise</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      arch<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">AsyncParallelHook</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„, è¡¨ç¤ºå‚æ•°ä¸ªæ•°</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è®¢é˜…</span>
  <span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯¥æ¬¡å¼‚æ­¥æ‰§è¡Œå®Œæˆ</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯¥æ¬¡å¼‚æ­¥æ‰§è¡Œå®Œæˆ</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//å‘å¸ƒ</span>
  <span class="token function">startPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>arch<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token string">'args'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é’©å­æ‰§è¡Œå®Œæˆ'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æ›´æ–°æ—¶é—´:</span> <span class="time">4/7/2021, 6:58:50 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html" class="prev">
        Webpack å¼‚æ­¥åŠ è½½
      </a></span> <span class="next"><a href="/blog/skills/æµè§ˆå™¨ç¼“å­˜.html">
        æµè§ˆå™¨ç¼“å­˜
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.7c77a4cc.js" defer></script><script src="/blog/assets/js/3.8c44ca0e.js" defer></script><script src="/blog/assets/js/38.1696d6ea.js" defer></script><script src="/blog/assets/js/4.57980df9.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack åŸºç¡€çŸ¥è¯† | Lorain&#39;s ä¸ªäººä¸»é¡µğŸ–Œ</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/blog/base/hd-img.jpg">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/base/hd-img.jpg">
    <meta name="description" content="å±±ä¸­æ¨—æ å¹´å¹´åœ¨ & çœ‹å°½è¥¿é£æœ¨æ§¿èŠ±">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    <link rel="preload" href="/blog/assets/css/0.styles.579a9854.css" as="style"><link rel="preload" href="/blog/assets/js/app.b45d52a8.js" as="script"><link rel="preload" href="/blog/assets/js/3.ab657a59.js" as="script"><link rel="preload" href="/blog/assets/js/27.1270bbeb.js" as="script"><link rel="preload" href="/blog/assets/js/4.022282fe.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.15efb885.js"><link rel="prefetch" href="/blog/assets/js/11.b69736a7.js"><link rel="prefetch" href="/blog/assets/js/12.1e4a5a90.js"><link rel="prefetch" href="/blog/assets/js/13.5028ca05.js"><link rel="prefetch" href="/blog/assets/js/14.ed5d061a.js"><link rel="prefetch" href="/blog/assets/js/15.a2f176cb.js"><link rel="prefetch" href="/blog/assets/js/16.5298f88a.js"><link rel="prefetch" href="/blog/assets/js/17.5f2beb7f.js"><link rel="prefetch" href="/blog/assets/js/18.e510d28d.js"><link rel="prefetch" href="/blog/assets/js/19.53886023.js"><link rel="prefetch" href="/blog/assets/js/20.63c552fe.js"><link rel="prefetch" href="/blog/assets/js/21.67e51d39.js"><link rel="prefetch" href="/blog/assets/js/22.42eb15fc.js"><link rel="prefetch" href="/blog/assets/js/23.db3c2d0c.js"><link rel="prefetch" href="/blog/assets/js/24.5ba591b0.js"><link rel="prefetch" href="/blog/assets/js/25.a1aa5fe0.js"><link rel="prefetch" href="/blog/assets/js/26.0ccf51ed.js"><link rel="prefetch" href="/blog/assets/js/28.52f2ae4c.js"><link rel="prefetch" href="/blog/assets/js/29.b85e431e.js"><link rel="prefetch" href="/blog/assets/js/30.1aef2e5e.js"><link rel="prefetch" href="/blog/assets/js/31.1abd6355.js"><link rel="prefetch" href="/blog/assets/js/32.03df97b0.js"><link rel="prefetch" href="/blog/assets/js/33.c00a706c.js"><link rel="prefetch" href="/blog/assets/js/34.2f847376.js"><link rel="prefetch" href="/blog/assets/js/35.63347724.js"><link rel="prefetch" href="/blog/assets/js/36.9fdc020c.js"><link rel="prefetch" href="/blog/assets/js/37.3392c04b.js"><link rel="prefetch" href="/blog/assets/js/38.ade4c9de.js"><link rel="prefetch" href="/blog/assets/js/39.6aec4626.js"><link rel="prefetch" href="/blog/assets/js/40.9c723d93.js"><link rel="prefetch" href="/blog/assets/js/5.904e5833.js"><link rel="prefetch" href="/blog/assets/js/6.2426cfb9.js"><link rel="prefetch" href="/blog/assets/js/7.7194594b.js"><link rel="prefetch" href="/blog/assets/js/8.e15df7e7.js"><link rel="prefetch" href="/blog/assets/js/9.3ff9262b.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.21b1897d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.579a9854.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Lorain's ä¸ªäººä¸»é¡µğŸ–Œ</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  ğŸ“œæŠ€æœ¯è¿›é˜¶
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  ğŸ“Šç®—æ³•ç›¸å…³
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  ğŸ€è®°å½•ç”Ÿæ´»
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  â­ï¸Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  ğŸ“œæŠ€æœ¯è¿›é˜¶
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  ğŸ“Šç®—æ³•ç›¸å…³
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  ğŸ€è®°å½•ç”Ÿæ´»
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  â­ï¸Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Client &amp; Side</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Build &amp; Tools</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°.html" class="sidebar-link">ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°</a></li><li><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html" class="active sidebar-link">Webpack åŸºç¡€çŸ¥è¯†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#module-chunk-bundle" class="sidebar-link">Module &amp; Chunk &amp; Bundle</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#åº“-library" class="sidebar-link">åº“(Library)</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#å…¥å£-entry" class="sidebar-link">å…¥å£(Entry)</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#npm3-çš„-peerdependency" class="sidebar-link">Npm3 çš„ peerDependency</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#html-webpack-plugin-ç–‘æƒ‘é€‰é¡¹" class="sidebar-link">Html-webpack-plugin ç–‘æƒ‘é€‰é¡¹</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#åŠ è½½å™¨-loaders" class="sidebar-link">åŠ è½½å™¨(Loaders)</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#å¸¸ç”¨-loaders" class="sidebar-link">å¸¸ç”¨ loaders</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#å¸¸ç”¨-plugins" class="sidebar-link">å¸¸ç”¨ plugins</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#å¸¸ç”¨ä¼˜åŒ–æ‰‹æ®µ" class="sidebar-link">å¸¸ç”¨ä¼˜åŒ–æ‰‹æ®µ</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#æ ¸å¿ƒé€‰é¡¹-optimization" class="sidebar-link">æ ¸å¿ƒé€‰é¡¹ optimization</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#éƒ¨åˆ†ç–‘æƒ‘é€‰é¡¹è®°å½•" class="sidebar-link">éƒ¨åˆ†ç–‘æƒ‘é€‰é¡¹è®°å½•</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#æ³¨å…¥å…¨å±€å˜é‡" class="sidebar-link">æ³¨å…¥å…¨å±€å˜é‡</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#long-term-cache" class="sidebar-link">Long Term Cache</a></li><li class="sidebar-sub-header"><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html#git-æäº¤é’©å­-husky-å’Œ-yorkie" class="sidebar-link">Git æäº¤é’©å­(husky å’Œ yorkie)</a></li></ul></li><li><a href="/blog/skills/Webpackæ¨¡å—å®ç°.html" class="sidebar-link">Webpack æ¨¡å—å®ç°</a></li><li><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html" class="sidebar-link">Webpack å¼‚æ­¥åŠ è½½</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Design &amp; Patterns</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Server &amp; Side</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-åŸºç¡€çŸ¥è¯†"><a href="#webpack-åŸºç¡€çŸ¥è¯†" class="header-anchor">#</a> Webpack åŸºç¡€çŸ¥è¯†</h1> <p>æ­¤å¤„è®°å½• webpack ä¸­çš„ä¸€äº›å…¥é—¨çŸ¥è¯†ç‚¹, æœ‰ç‚¹æ‚ä¹±, ä¸»è¦ç”¨äºå›é¡¾</p> <h2 id="module-chunk-bundle"><a href="#module-chunk-bundle" class="header-anchor">#</a> Module &amp; Chunk &amp; Bundle</h2> <blockquote><p>module: æ¨¡å—å°±æ˜¯æ¨¡å—å¯ä»¥æ˜¯ es æ¨¡å—ä¹Ÿå¯ä»¥æ˜¯ commonJS æˆ–è€… AMD æ¨¡å—</p></blockquote> <blockquote><p>chunk: æ‰“åŒ…è¿‡ç¨‹ä¸­è¢«æ“ä½œçš„æ¨¡å—æ–‡ä»¶å«åš chunk,ä¾‹å¦‚å¼‚æ­¥åŠ è½½ä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ª chunk</p></blockquote> <blockquote><p>bundle: bundle æ˜¯æœ€åæ‰“åŒ…åçš„æ–‡ä»¶,æœ€ç»ˆæ–‡ä»¶å¯ä»¥å’Œ chunk é•¿çš„ä¸€æ¨¡ä¸€æ ·,ä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä»–æ˜¯å¤šä¸ª chunk çš„é›†åˆ</p></blockquote> <p>å¦å¤–çš„ç†è§£(æ‘˜è‡³ç½‘ç»œ):</p> <ul><li><p>moduleï¼š</p> <p>å°±æ˜¯ js çš„æ¨¡å—åŒ– webpack æ”¯æŒ commonJSã€ES6 ç­‰æ¨¡å—åŒ–è§„èŒƒï¼Œç®€å•æ¥è¯´å°±æ˜¯ä½ é€šè¿‡ import è¯­å¥å¼•å…¥çš„ä»£ç ã€‚</p></li> <li><p>chunk:</p> <p>chunk æ˜¯ webpack æ ¹æ®åŠŸèƒ½æ‹†åˆ†å‡ºæ¥çš„ï¼ŒåŒ…å«ä¸‰ç§æƒ…å†µï¼š</p> <p>1ã€ä½ çš„é¡¹ç›®å…¥å£ï¼ˆentryï¼‰</p> <p>2ã€é€šè¿‡ import()åŠ¨æ€å¼•å…¥çš„ä»£ç </p> <p>3ã€é€šè¿‡ splitChunks æ‹†åˆ†å‡ºæ¥çš„ä»£ç </p> <p>chunk å¯ä»¥åŒ…å«å¤šä¸ª module, æ˜¯ç”±moduleç»„æˆçš„ ã€‚</p></li> <li><p>bundleï¼š</p> <p>bundle æ˜¯ webpack æ‰“åŒ…ä¹‹åçš„å„ä¸ªæ–‡ä»¶ï¼Œä¸€èˆ¬å°±æ˜¯å’Œ chunk æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œbundle å°±æ˜¯å¯¹ chunk è¿›è¡Œç¼–è¯‘å‹ç¼©æ‰“åŒ…ç­‰å¤„ç†ä¹‹åçš„äº§å‡ºã€‚</p></li></ul> <hr> <h2 id="åº“-library"><a href="#åº“-library" class="header-anchor">#</a> åº“(Library)</h2> <p>å¦‚æœæƒ³å°†è‡ªå·±çš„å·¥ç¨‹ä½œä¸ºä¸€ä¸ªç¬¬ä¸‰æ–¹åº“æä¾›ç»™å…¶ä»–äººä½¿ç”¨,å¯ä»¥å‚è€ƒ<a href="https://github.com/webpack/webpack/tree/master/examples/multi-part-library" target="_blank" rel="noopener noreferrer">é…ç½®æ–¹æ³•<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// mode: &quot;development || &quot;production&quot;,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    alpha<span class="token operator">:</span> <span class="token string">'./alpha'</span><span class="token punctuation">,</span>
    beta<span class="token operator">:</span> <span class="token string">'./beta'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'MyLibrary.[name].js'</span><span class="token punctuation">,</span>
    <span class="token comment">// å¾å¯¹å¤šé¡µé¢,å¯ä»¥é…ç½®ä¸ºæ•°ç»„,MyLibraryä½œä¸ºæ•´ä½“çš„å‘½åç©ºé—´,[name]ä½œä¸ºè¯¥ç©ºé—´çš„å±æ€§è°ƒç”¨</span>
    <span class="token comment">// ç¤ºä¾‹åœ°å€:</span>
    <span class="token comment">//https://github.com/webpack/webpack/tree/master/examples/multi-part-library</span>
    library<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'MyLibrary'</span><span class="token punctuation">,</span> <span class="token string">'[name]'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    libraryTarget<span class="token operator">:</span> <span class="token string">'umd'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="å…¥å£-entry"><a href="#å…¥å£-entry" class="header-anchor">#</a> å…¥å£(Entry)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¯¹è±¡å¼</span>
<span class="token punctuation">{</span>
  entry<span class="token operator">:</span><span class="token punctuation">{</span>
    app<span class="token operator">:</span><span class="token string">'./file.js'</span><span class="token punctuation">,</span>
    vendor<span class="token operator">:</span> <span class="token string">'./file1.js'</span><span class="token punctuation">,</span> <span class="token comment">//å¤šé¡µé¢</span>
    normal<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">,</span><span class="token string">'lodash'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//ä¸¤ä¸ªchunkæ‰“åŒ…åˆ°ä¸€ä¸ªbundle</span>
    <span class="token string">'js/home'</span><span class="token operator">:</span> <span class="token string">'./files2.js'</span> <span class="token comment">// ä¼šç”Ÿæˆåˆ°js/homeæ–‡ä»¶å¤¹ä¸‹</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// å­—ç¬¦ä¸²å¼</span>
<span class="token punctuation">{</span>
  entry<span class="token operator">:</span><span class="token string">'app'</span> <span class="token comment">// ç­‰åŒäº entry:{ main:'app.js' }</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="npm3-çš„-peerdependency"><a href="#npm3-çš„-peerdependency" class="header-anchor">#</a> Npm3 çš„ peerDependency</h2> <p>å‡å¦‚ é¡¹ç›® project-main ä¾èµ–çš„ package-a(dependency) çš„ package.json ä¸­å£°æ˜äº† peerDependency æ˜¯ package-apeer@^1.0.0ï¼Œè€Œ project-main ä¸­æ²¡æœ‰ä»»ä½• package-apeer çš„é…ç½®ï¼Œæ­¤æ—¶åœ¨ project-main ä¸‹ä½¿ç”¨ npm3 æ‰§è¡Œ npm installï¼Œæ§åˆ¶å°å°±ä¼šå‘Šè­¦ UNMET PEER DEPENDENCY package-apeer@^1.0.0ï¼Œæ„æ€å°±æ˜¯è¯´ä½¿ç”¨åˆ° package-a çš„é¡¹ç›®å¿…é¡»å®‰è£…åŒæ—¶å®‰è£… package-apeer@^1.0.0 ï¼Œå¦åˆ™ç¨‹åºå°±å¯èƒ½ä¼šæœ‰å¼‚å¸¸ï¼Œè€Œåœ¨ npm@1 å’Œ npm@2 ä¸‹ï¼Œå°±ä¸ä¼šæŠ¥é”™è€Œæ˜¯è‡ªåŠ¨æŠŠ package-apeer@^1.0.0 å®‰è£…ä¸Šï¼Œå› ä¸ºå¾ˆå¤šç”¨æˆ·ååº”è¿™æ ·å¾ˆå›°æƒ‘ï¼Œæˆ‘æ²¡å£°æ˜è¿™ä¸ªåŒ…ï¼Œä½ ä¸ºä»€ä¹ˆè¦ç»™æˆ‘å®‰è£…å‘¢ï¼Ÿæ‰€ä»¥åœ¨ npm@3 ä¸­è¿™ä¸ª peerDependencies å¦‚æœæ²¡è£…å°±å˜æˆäº†æ§åˆ¶å°å‘Šè­¦ã€‚</p> <p>npm3 çš„å®˜æ–¹æ–‡æ¡£ ä¸­ è®°å½•åˆ°:</p> <blockquote><p>é€šå¸¸æ˜¯åœ¨æ’ä»¶å¼€å‘çš„åœºæ™¯ä¸‹ï¼Œä½ çš„æ’ä»¶éœ€è¦æŸäº›ä¾èµ–çš„æ”¯æŒï¼Œä½†æ˜¯ä½ åˆæ²¡å¿…è¦å»å®‰è£…ï¼Œå› ä¸ºæ’ä»¶çš„å®¿ä¸»ä¼šå»å®‰è£…è¿™äº›ä¾èµ–ï¼Œä½ å°±å¯ä»¥ç”¨ peerDependencies å»å£°æ˜ä¸€ä¸‹éœ€è¦ä¾èµ–çš„æ’ä»¶å’Œç‰ˆæœ¬ï¼Œå¦‚æœå‡ºé—®é¢˜ npm å°±ä¼šæœ‰è­¦å‘Šæ¥æé†’ä½¿ç”¨è€…å»è§£å†³ç‰ˆæœ¬å†²çªé—®é¢˜ã€‚</p></blockquote> <h2 id="html-webpack-plugin-ç–‘æƒ‘é€‰é¡¹"><a href="#html-webpack-plugin-ç–‘æƒ‘é€‰é¡¹" class="header-anchor">#</a> Html-webpack-plugin ç–‘æƒ‘é€‰é¡¹</h2> <ul><li><p><code>chunks</code></p> <blockquote><p>chunks é€‰é¡¹çš„ä½œç”¨ä¸»è¦æ˜¯é’ˆå¯¹å¤šå…¥å£(entry)æ–‡ä»¶ã€‚å½“ä½ æœ‰å¤šä¸ªå…¥å£æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯¹åº”å°±ä¼šç”Ÿæˆå¤šä¸ªç¼–è¯‘åçš„ js æ–‡ä»¶ã€‚é‚£ä¹ˆ chunks é€‰é¡¹å°±å¯ä»¥å†³å®šæ˜¯å¦éƒ½ä½¿ç”¨è¿™äº›ç”Ÿæˆçš„ js æ–‡ä»¶ã€‚</p></blockquote> <blockquote><p>chunks é»˜è®¤ä¼šåœ¨ç”Ÿæˆçš„ html æ–‡ä»¶ä¸­å¼•ç”¨æ‰€æœ‰çš„ js æ–‡ä»¶ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå¼•å…¥å“ªäº›ç‰¹å®šçš„æ–‡ä»¶ã€‚</p></blockquote> <blockquote><p>çœ‹ä¸€ä¸ªå°ä¾‹å­ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// webpack.config.js</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
      index<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      index1<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/index1.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      index2<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/index2.js'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token operator">...</span>
          chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token string">'index2'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
</code></pre></div><p>æ‰§è¡Œ webpack å‘½ä»¤ä¹‹åï¼Œä½ ä¼šçœ‹åˆ°ç”Ÿæˆçš„ index.html æ–‡ä»¶ä¸­ï¼Œåªå¼•ç”¨äº† index.js å’Œ index2.js, è€Œå¦‚æœæ²¡æœ‰æŒ‡å®š chunks é€‰é¡¹ï¼Œé»˜è®¤ä¼šå…¨éƒ¨å¼•ç”¨ã€‚</p> <div class="language-html extra-class"><pre class="language-html"><code>  ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span>text/javascript</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span>index.js</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span>text/javascript</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span>index2.js</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p><code>excludeChunks</code></p> <p>å¼„æ‡‚äº† chunks ä¹‹åï¼ŒexcludeChunks é€‰é¡¹ä¹Ÿå°±å¥½ç†è§£äº†ï¼Œè·Ÿ chunks æ˜¯ç›¸åçš„ï¼Œæ’é™¤æ‰æŸäº› js æ–‡ä»¶ã€‚ æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå…¶å®ç­‰ä»·äºä¸‹é¢è¿™ä¸€è¡Œ</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token operator">...</span>
  excludeChunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'index1.js'</span><span class="token punctuation">]</span>
</code></pre></div></li></ul> <h2 id="åŠ è½½å™¨-loaders"><a href="#åŠ è½½å™¨-loaders" class="header-anchor">#</a> åŠ è½½å™¨(Loaders)</h2> <p>loaders é…ç½®é¡¹ use å’Œ loader çš„åŒºåˆ«<a href="https://webpack.docschina.org/migrate/3/" target="_blank" rel="noopener noreferrer">å‚è€ƒé“¾æ¥-webpack1 å‡çº§ webpack2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>webpack1 æ˜¯ä½¿ç”¨ loader é€‰é¡¹,è€Œ webpack2 ä»¥ä¸Šçš„ç‰ˆæœ¬éƒ½å»ºè®®ç›´æ¥ä½¿ç”¨ use é€‰é¡¹,å…·ä½“çš„æ›´æ–°å¦‚ä¸‹:</p> <ul><li>å¤–å±‚ loaders æ”¹ä¸º rules</li> <li>å†…å±‚ loader æ”¹ä¸º use,ä¹Ÿå¯ä»¥ç”¨ loader</li> <li>æ‰€æœ‰æ’ä»¶å¿…é¡»åŠ ä¸Š -loaderï¼Œä¸å†å…è®¸ç¼©å†™</li> <li>ä¸å†æ”¯æŒä½¿ç”¨!è¿æ¥æ’ä»¶ï¼Œæ”¹ä¸ºæ•°ç»„å½¢å¼</li> <li>json-loader æ¨¡å—ç§»é™¤ï¼Œä¸å†éœ€è¦æ‰‹åŠ¨æ·»åŠ ï¼Œwebpack2 ä¼šè‡ªåŠ¨å¤„ç†</li></ul> <p>Webpack1 ä¸­å¦‚ä¸‹é…ç½®</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.(less|css)$/</span><span class="token punctuation">,</span>
      loader<span class="token operator">:</span> <span class="token string">'style!css!less!postcss'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.json$/</span><span class="token punctuation">,</span>
      loader<span class="token operator">:</span> <span class="token string">'json'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Webpack2 å´ä½¿ç”¨å¦‚ä¸‹é…ç½®</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.(less|css)$/</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨ç¤ºä¾‹</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.jsx$/</span><span class="token punctuation">,</span>
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Do not use &quot;use&quot; here</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
      <span class="token comment">// å¯ä»¥é…ç½®æˆå­—ç¬¦ä¸²</span>
      loader<span class="token operator">:</span> <span class="token string">&quot;style-loader!css-loader!less-loader&quot;</span>
      <span class="token comment">// ä¹Ÿå¯ä»¥é…ç½®æˆæ•°ç»„,å¹¶é€šè¿‡queryStringæ¥è®¾å®šé€‰é¡¹(ä¼ å‚ç»™loader)</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader?minimize&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;less-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// ä½¿ç”¨optionsæ¥è®¾å®šé€‰é¡¹</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
              minimize<span class="token operator">:</span><span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¡¥å……è¯´æ˜ä¸€ä¸‹, æ­£å¦‚ Webpack 2 è¿ç§»æ•™ç¨‹æ‰€è¿°ï¼Œä¸¤è€…ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªåŠ è½½å™¨æ•°ç»„ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ useï¼Œå¦‚æœå®ƒåªæ˜¯ä¸€ä¸ªåŠ è½½å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ loaderï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.jsx$/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Do not use &quot;use&quot; here</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;style-loader!css-loader!less-loader&quot;</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;less-loader&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>`
</code></pre></div><p>loader ä¹Ÿå¯ä»¥ä½¿ç”¨ import æˆ–è€… require ç›´æ¥æŒ‡å®š:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'style-loader!css-loader?minimize!./main.css'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Styles <span class="token keyword">from</span> <span class="token string">'style-loader!css-loader?modules!./styles.css'</span><span class="token punctuation">;</span>
<span class="token comment">// é€‰é¡¹å¯ä»¥ä¼ é€’æŸ¥è¯¢å‚æ•°ï¼Œä¾‹å¦‚ ?key=value&amp;foo=barï¼Œæˆ–è€…ä¸€ä¸ª JSON å¯¹è±¡ï¼Œä¾‹å¦‚ ?{&quot;key&quot;:&quot;value&quot;,&quot;foo&quot;:&quot;bar&quot;}</span>
</code></pre></div><p><strong>Loader çš„å‡ ç§ç”¨æ³•å½’çº³</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>ç¬¬ä¸€ç§<span class="token operator">:</span> use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'xxx-loader'</span><span class="token punctuation">,</span> <span class="token string">'xxx-loader'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

ç¬¬äºŒç§<span class="token operator">:</span> loader<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

ç¬¬ä¸‰ç§<span class="token operator">:</span> use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">'style-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">'css-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="å¸¸ç”¨-loaders"><a href="#å¸¸ç”¨-loaders" class="header-anchor">#</a> å¸¸ç”¨ loaders</h2> <ul><li><code>css-loader</code></li></ul> <p>css-laoder æ˜¯è§£é‡Š @import 'a.css' å’Œ @import url(a.css)ç­‰å¼•å…¥çš„.css æ–‡ä»¶, å°†å…¶åŠ è½½åˆ° js æ–‡ä»¶ä¸­,ä¾¿äº webpack çš„å…¶ä»– loader å¤„ç†</p> <ul><li><code>style-loader</code></li></ul> <p>style-loaders ç”¨äºå¤„ç†å°†æ‰€æœ‰çš„æ ·å¼æ–‡ä»¶æ’å…¥åˆ°<code>&lt;style&gt;&lt;/style&gt;</code>ä¸­</p> <ul><li><code>url-loader</code></li></ul> <p>url-loader æ˜¯ç”¨äºå¤„ç†æ–‡ä»¶(css/js)ä¸­çš„ä¸­å¼•ç”¨çš„èµ„æº. ä¾‹å¦‚å›¾ç‰‡å¼•å…¥, å°å›¾ç‰‡è½¬æ¢æˆ base64...</p> <ul><li><code>postcss-loader</code></li></ul> <p>postcss-loader çš„ autoprefixer å®ç°å°† css3 å±æ€§æ·»åŠ ä¸Šå‚å•†å‰ç¼€</p> <hr> <h2 id="å¸¸ç”¨-plugins"><a href="#å¸¸ç”¨-plugins" class="header-anchor">#</a> å¸¸ç”¨ plugins</h2> <ul><li><p>DllPlugin &amp; DllReferencePlugin (åŠ¨æ€é“¾æ¥åº“æ’ä»¶)</p> <p>dll æ’ä»¶ä¸€èˆ¬åªåº”ç”¨äºå¼€å‘ç¯å¢ƒ,æ­£å¼ç¯å¢ƒä¸­ä¸å»ºè®®è¿™ä¹ˆåš</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// æ¥å…¥ DllPlugin</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// åŠ¨æ€é“¾æ¥åº“çš„å…¨å±€å˜é‡åç§°ï¼Œéœ€è¦å’Œ output.library ä¸­ä¿æŒä¸€è‡´</span>
      <span class="token comment">// è¯¥å­—æ®µçš„å€¼ä¹Ÿå°±æ˜¯è¾“å‡ºçš„ manifest.json æ–‡ä»¶ ä¸­ name å­—æ®µçš„å€¼</span>
      name<span class="token operator">:</span> <span class="token string">'[name]_dll_[hash]'</span><span class="token punctuation">,</span>
      <span class="token comment">// æè¿°åŠ¨æ€é“¾æ¥åº“çš„ manifest.json æ–‡ä»¶è¾“å‡ºæ—¶çš„æ–‡ä»¶åç§°</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/dll'</span><span class="token punctuation">,</span> <span class="token string">'[name].manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token comment">// æ¥å…¥ DllPlugin</span>
  <span class="token keyword">new</span> <span class="token class-name">DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
    <span class="token comment">// æè¿° react åŠ¨æ€é“¾æ¥åº“çš„æ–‡ä»¶å†…å®¹</span>
    manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/react.manifest.json'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>webpack-bundle-analyzer (æ€§èƒ½åˆ†ææ’ä»¶)</p></li> <li><p>WebpackMd5Hash</p> <p>æ³¨æ„: webpack-md5-hash æœ‰ç›¸å…³é—®é¢˜è¯·<a href="https://sebastianblade.com/using-webpack-to-achieve-long-term-cache/" target="_blank" rel="noopener noreferrer">æŸ¥çœ‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>ä½¿ç”¨è¯¥æ’ä»¶å,æ¨¡å—ä¸å…¬å…±ä»£ç çš„æ˜ å°„å…³ç³»æ–‡ä»¶(manifest),å°†ä¸ä¼š éšç€æ¨¡å—çš„æ”¹åŠ¨æ¥é‡æ–° è®¡ç®—å…¬å…±ä»£ç çš„ chunkhash</p></blockquote> <p>å› æ­¤ webpack-md5-hash å¹¶æ²¡æœ‰è§£å†³ä¹‹å‰çš„é—®é¢˜ï¼š</p> <div class="language- extra-class"><pre><code>å¦‚ä½•ç”Ÿæˆç¨³å®šçš„æ¨¡å— IDï¼Ÿ

å¦‚ä½•é¿å…é¢‘ç¹çš„ chunk å†…å®¹å˜åŠ¨ï¼Ÿ
</code></pre></div><p>ä½¿ç”¨ NamedModulesPlugin æ¥è§£å†³</p></li> <li><p>NamedChunksPlugin</p> <p>webpack4.25 ä»¥ä¸Šæœ‰ä¸¤ä¸ªé€‰é¡¹æ¥æ§åˆ¶è¿™ä¸ªæ’ä»¶: namedChunks å’Œ chunkIds</p> <p>è¿™ä¸¤ä¸ªæ’ä»¶åœ¨æ›´é«˜çš„ç‰ˆæœ¬å·²ç»åˆå¹¶ä¸ºäº† chunkIds,è¯¦è§<a href="https://github.com/webpack/webpack/issues/8354" target="_blank" rel="noopener noreferrer">é“¾æ¥<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>å›ºåŒ– runtime ä»£ç  å†…ä»¥åŠåœ¨ä½¿ç”¨åŠ¨æ€åŠ è½½æ—¶åˆ†ç¦»å‡ºçš„ chunk çš„ chunk id</p></blockquote></li> <li><p>NamedModulesPlugin(webpack4 å¼€å‘æ¨¡å¼é»˜è®¤å€¼,ä¸éœ€è¦å•ç‹¬é…ç½®äº†)</p> <blockquote><p>å½“å¼€å¯ HMR çš„æ—¶å€™ä½¿ç”¨è¯¥æ’ä»¶ä¼šæ˜¾ç¤ºæ¨¡å—çš„ç›¸å¯¹è·¯å¾„ï¼Œå»ºè®®ç”¨äºå¼€å‘ç¯å¢ƒã€‚</p></blockquote> <blockquote><p>å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨æ¥å›ºåŒ– module id</p></blockquote> <blockquote><p>webpack.NamedChunksPlugin åªèƒ½å¯¹æ™®é€šçš„ Webpack æ¨¡å—èµ·ä½œç”¨ï¼Œå¼‚æ­¥æ¨¡å—ï¼Œexternal æ¨¡å—æ˜¯ä¸ä¼šèµ·ä½œç”¨çš„ã€‚</p></blockquote> <blockquote><p><strong>å¾å¯¹ä¸Šè¿°çš„é—®é¢˜è§£å†³åŠæ³•:</strong></p></blockquote> <ol><li><p>å¼‚æ­¥æ¨¡å—å¯ä»¥åœ¨ import çš„æ—¶å€™åŠ ä¸Š chunkName çš„æ³¨é‡Šï¼Œæ¯”å¦‚è¿™æ ·ï¼š<code>import(/* webpackChunkName: &quot;lodash&quot; */ 'lodash').then()</code> è¿™æ ·å°±æœ‰ Name äº†</p></li> <li><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å†ä½¿ç”¨ä¸€ä¸ªæ’ä»¶ï¼š<code>name-all-modules-plugin</code>
è¿™ä¸ªæ’ä»¶ä¸­ç”¨åˆ°ä¸€äº›è€çš„ APIï¼ŒWebpack 4 ä¼šå‘å‡ºè­¦å‘Šï¼Œè¿™ä¸ª <a href="https://github.com/timse/name-all-modules-plugin/pull/2/commits/18b460556e625908ca419c1e4798451ab0c5d788" target="_blank" rel="noopener noreferrer">pr<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æœ‰æ–°çš„ç‰ˆæœ¬ï¼Œä¸è¿‡ä½œè€…ä¸ä¸€å®šä¼š mergeã€‚æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥ copy è¿™ä¸ªæ’ä»¶çš„ä»£ç åˆ°æˆ‘ä»¬çš„ Webpack é…ç½®é‡Œé¢ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">//prçš„æ ¸å¿ƒä»£ç </span>
 <span class="token keyword">class</span> <span class="token class-name">NameAllModulesPlugin</span> <span class="token punctuation">{</span>
   <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;NameAllModulesPlugin&quot;</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>beforeModuleIds<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;NameAllModulesPlugin&quot;</span><span class="token punctuation">,</span> <span class="token parameter">modules</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>id <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             module<span class="token punctuation">.</span>id <span class="token operator">=</span> module<span class="token punctuation">.</span><span class="token function">identifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div></li></ol></li> <li><p>HashedModuleIdsPlugin</p> <blockquote><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨æ¥å›ºåŒ– module id,å°±æ˜¯åœ¨ namedModulesPlugin çš„åŸºç¡€ä¸Šåšäº†è·¯å¾„çš„ hash,ç®€åŒ–è·¯å¾„å€¼, å‡å° chunk çš„</p></blockquote></li> <li><p>CommonsChunkPlugin(webpack3 ä¸­çš„å…¬å…±ä»£ç æå–æ’ä»¶)</p> <blockquote><p>HashedModuleIdsPlugin: å®ƒæ˜¯æ ¹æ®æ¨¡å—ç›¸å¯¹è·¯å¾„ç”Ÿæˆæ¨¡å—æ ‡è¯†ï¼Œå¦‚æœæ¨¡å—æ²¡æœ‰æ”¹å˜ï¼Œé‚£æ¨¡å—æ ‡è¯†ä¹Ÿä¸ä¼šæ”¹å˜, æ”¹å˜ webpack-&gt;entry çš„é¡ºåºä¹Ÿå°†ä¸æ”¹å˜æ¨¡å—çš„ ID, ä¹Ÿå°±ä¸ä¼šå½±å“ hash å’Œ chunkhash çš„æ”¹å˜</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'common'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// ç”¨äºæå–manifest</span>
      minChunks<span class="token operator">:</span> <span class="token number">Infinity</span> <span class="token comment">// Infinityä¸ä¼šæ‰“åŒ…ä»»ä½•å¤šä½™çš„ä»£ç </span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HashedModuleIdsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">WebpackMd5Hash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>splitChunks (webpack4)</p> <blockquote><p>é»˜è®¤çš„åˆ†åŒ…ç­–ç•¥:(æ¡ä»¶éœ€è¦å…¨æ»¡è¶³)</p></blockquote> <div class="language- extra-class"><pre><code>-  æ–°çš„ chunk æ˜¯å¦è¢«å…±äº«2æ¬¡ä»¥ä¸Šæˆ–è€…æ˜¯æ¥è‡ª node_modules çš„æ¨¡å—
-  æ–°çš„ chunk ä½“ç§¯åœ¨å‹ç¼©ä¹‹å‰æ˜¯å¦å¤§äº 30kb
-  æŒ‰éœ€åŠ è½½ chunk çš„å¹¶å‘è¯·æ±‚æ•°é‡å°äºç­‰äº 5 ä¸ª
-  é¡µé¢åˆå§‹åŠ è½½æ—¶çš„å¹¶å‘è¯·æ±‚æ•°é‡å°äºç­‰äº 3 ä¸ª
</code></pre></div></li></ul> <blockquote><p>é»˜è®¤é…ç½®:</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// æå–webpackè¿è¡Œæ—¶çš„ä»£ç å—å•ç‹¬å¼•å…¥åˆ°å…¥å£æ–‡ä»¶</span>
    <span class="token comment">// è€Œä¸æ˜¯ç›´æ¥æ··å…¥æ¯ä¸ªchunk,å¯ä»¥å‡å°å…¥å£çš„ä»£ç ä½“ç§¯</span>
    <span class="token comment">// å­˜å‚¨ç€ webpack å¯¹ module å’Œ chunk çš„è§£æä¿¡æ¯</span>
    <span class="token comment">// ä¸»è¦ä½œç”¨: æŠŠentryä¸­ä¸ç›¸å…³çš„ module id æˆ–è€…è¯´å†…å®¹æ‘’é™¤åœ¨å¤–</span>
    <span class="token comment">//</span>
    runtimeChunk<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">//èŒƒå›´:å¼‚æ­¥åŠ è½½çš„æ¨¡å—ä¸­çš„å¼•å…¥importæ‰è¿›è¡Œæ‹†åˆ†</span>
      chunks<span class="token operator">:</span> <span class="token string">'async'</span><span class="token punctuation">,</span> <span class="token comment">// inital(å…¥å£) all(æ‰€æœ‰) async(å¼‚æ­¥)</span>
      minSize<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// å¤§äº30kbçš„</span>
      minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// å¼•ç”¨ä¸€æ¬¡å°±æ‹†åˆ†</span>
      maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// å¼‚æ­¥åŠ è½½æ¨¡å—æœ€å¤šå¯ä»¥æ‹†åˆ†çš„å—æ•°é‡</span>
      maxInitialRequests<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// ä¸€ä¸ªå…¥å£æ¨¡å—æœ€å¤šå¯ä»¥æ‹†åˆ†çš„å—æ•°é‡</span>
      automaticNameDelimiter<span class="token operator">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span> <span class="token comment">// æ¨¡å—æ‹†åˆ†åç§°çš„è¿æ¥ç¬¦</span>
      <span class="token comment">// å€¼ä¸ºtrue:webpackä¼šåŸºäºä»£ç å—å’Œç¼“å­˜ç»„çš„keyè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªåç§°</span>
      <span class="token comment">// å½“ä¸€ä¸ªåç§°åŒ¹é…åˆ°ç›¸åº”çš„å…¥å£åç§°ï¼Œè¿™ä¸ªå…¥å£ä¼šè¢«ç§»é™¤ã€‚</span>
      name<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">//å‘½ä¸­ä»¥ä¸‹è§„åˆ™å°†è¢«ä»£ç æ‹†åˆ†</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendors<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// node_modulesä¸­çš„æ¨¡å—</span>
          test<span class="token operator">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// defaultå€¼æ”¹ä¸ºfalseåˆ™å…³é—­è¿™ä¸ªåŒ¹é…æ¡ä»¶</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// é¡µé¢å¼•ç”¨2æ¬¡ä»¥ä¸Šçš„æ¨¡å—</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// åŒä¼˜å…ˆçº§çš„è§„åˆ™,ä»¥ä»ä¸Šåˆ°ä¸‹æ¥åŒ¹é…</span>
          <span class="token comment">// å¤ç”¨å·²ç»å­˜åœ¨çš„ä»£ç å—</span>
          <span class="token comment">// éœ€è¦åœ¨ç²¾ç¡®åŒ¹é…åˆ°å¯¹åº”æ¨¡å—æ—¶å€™æ‰ä¼šç”Ÿæ•ˆ</span>
          reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>maxInitialRequests: ä¸€ä¸ªå…¥å£æ¨¡å—æœ€å¤šå¯ä»¥æ‹†åˆ†çš„ä»£ç å— chunk æ•°é‡</p></blockquote> <div class="language- extra-class"><pre><code>    * è§„åˆ™:

    -  å…¥å£æ–‡ä»¶æœ¬èº«ç®—ä¸€ä¸ªè¯·æ±‚
    -  å¦‚æœå…¥å£é‡Œé¢æœ‰åŠ¨æ€åŠ è½½å¾—æ¨¡å—è¿™ä¸ªä¸ç®—åœ¨å†…
    -  é€šè¿‡ runtimeChunk æ‹†åˆ†å‡ºçš„ runtime ä¸ç®—åœ¨å†…
    -  åªç®— js æ–‡ä»¶çš„è¯·æ±‚ï¼Œcss ä¸ç®—åœ¨å†…
    -  å¦‚æœåŒæ—¶åˆä¸¤ä¸ªæ¨¡å—æ»¡è¶³ cacheGroup çš„è§„åˆ™è¦è¿›è¡Œæ‹†åˆ†ï¼Œ
      ä½†æ˜¯  maxInitialRequests çš„å€¼åªèƒ½å…è®¸å†æ‹†åˆ†ä¸€ä¸ªæ¨¡å—ï¼Œ
      é‚£å°ºå¯¸æ›´å¤§çš„æ¨¡å—ä¼šè¢«æ‹†åˆ†å‡ºæ¥
</code></pre></div><blockquote><p>maxAsyncRequests: å¼‚æ­¥æŒ‰éœ€åŠ è½½æ¨¡å—æœ€å¤šå¯æ‹†åˆ†çš„ä»£ç å— chunk æ•°é‡</p></blockquote> <div class="language- extra-class"><pre><code>    * è§„åˆ™:

    - import()æ–‡ä»¶æœ¬èº«ç®—ä¸€ä¸ªè¯·æ±‚
    - å¹¶ä¸ç®— js ä»¥å¤–çš„å…¬å…±èµ„æºè¯·æ±‚æ¯”å¦‚ css
    - å¦‚æœåŒæ—¶åˆä¸¤ä¸ªæ¨¡å—æ»¡è¶³ cacheGroup çš„è§„åˆ™è¦è¿›è¡Œæ‹†åˆ†ï¼Œ
      ä½†æ˜¯ maxInitialRequests çš„å€¼åªèƒ½å…è®¸å†æ‹†åˆ†ä¸€ä¸ªæ¨¡å—ï¼Œ
      é‚£å°ºå¯¸æ›´å¤§çš„æ¨¡å—ä¼šè¢«æ‹†åˆ†å‡ºæ¥
</code></pre></div><ul><li><p>ParallelUglifyPlugin(å¹¶è¡Œæ’ä»¶)</p> <p>æ³¨æ„: è¯¥æ’ä»¶å·²ç»æ— äºº ç»´æŠ¤,å¯ä»¥ç”¨ terser-webpack-plugin</p> <p>è¿™ä¸ªæ’ä»¶å¯ä»¥å¸®åŠ©æœ‰å¾ˆå¤šå…¥å£ç‚¹çš„é¡¹ç›®åŠ å¿«æ„å»ºé€Ÿåº¦ã€‚æŠŠå¯¹ JS æ–‡ä»¶çš„ä¸²è¡Œå‹ç¼©å˜ä¸ºå¼€å¯å¤šä¸ªå­è¿›ç¨‹å¹¶è¡Œè¿›è¡Œ uglifyã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpck.config.js</span>

<span class="token keyword">const</span> ParallelUglifyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-parallel-uglify-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">ParallelUglifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      workerCount<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      uglifyJS<span class="token operator">:</span> <span class="token punctuation">{</span>
          output<span class="token operator">:</span> <span class="token punctuation">{</span>
              beautify<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// ä¸éœ€è¦æ ¼å¼åŒ–</span>
              comments<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// ä¿ç•™æ³¨é‡Š</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          compress<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// å‹ç¼©</span>
              warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// åˆ é™¤æ— ç”¨ä»£ç æ—¶ä¸è¾“å‡ºè­¦å‘Š</span>
              drop_console<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// åˆ é™¤consoleè¯­å¥</span>
              <span class="token comment">// å†…åµŒå®šä¹‰äº†ä½†æ˜¯åªæœ‰ç”¨åˆ°ä¸€æ¬¡çš„å˜é‡</span>
              collapse_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token comment">// æå–å‡ºå‡ºç°å¤šæ¬¡ä½†æ˜¯æ²¡æœ‰å®šä¹‰æˆå˜é‡å»å¼•ç”¨çš„é™æ€å€¼</span>
              reduce_vars<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">]</span>

</code></pre></div></li> <li><p>speed-measure-webpack-plugin</p> <p>ç”¨æ¥æ£€æµ‹ webpack æ‰“åŒ…è¿‡ç¨‹ä¸­å„ä¸ªéƒ¨åˆ†æ‰€èŠ±è´¹çš„æ—¶é—´</p></li> <li><p>webpack åŠ¨æ€å¼•å…¥èµ„æº, ä½¿ç”¨ prefetch å’Œ preload</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpackChunkName: æ‰“åŒ…åçš„æ–‡ä»¶å,é˜²æ­¢å‡ºç°1.js,2.jsè¿™ç§</span>
<span class="token comment">// webpackPrefetch: å¼€å¯prefetch (é¡µé¢ç©ºé—²æ—¶è¯·æ±‚, ä¼˜å…ˆçº§ä¸­ç­‰)</span>
<span class="token comment">// webpackPreload: å¼€å¯preload (æ›´é«˜çš„ä¼˜å…ˆçº§,ä¸é˜»å¡onloadäº‹ä»¶)</span>

<span class="token keyword">import</span><span class="token punctuation">(</span>
  <span class="token comment">/* webpackPrefetch: true */</span>
  <span class="token comment">/*webpackChunkName: 'topic'*/</span>

  <span class="token string">'../topic'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>ParallelUglifyPlugin(å¹¶è¡Œå¤šè¿›ç¨‹å‹ç¼© js æ–‡ä»¶)</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ParallelUglifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// ä¼ é€’ç»™ UglifyJS çš„å‚æ•°</span>
      uglifyJS<span class="token operator">:</span> <span class="token punctuation">{</span>
        output<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// æœ€ç´§å‡‘çš„è¾“å‡º</span>
          beautify<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token comment">// åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Š</span>
          comments<span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        compress<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// åœ¨UglifyJsåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„ä»£ç æ—¶ä¸è¾“å‡ºè­¦å‘Š</span>
          warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token comment">// åˆ é™¤æ‰€æœ‰çš„ `console` è¯­å¥ï¼Œå¯ä»¥å…¼å®¹ieæµè§ˆå™¨</span>
          drop_console<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment">// å†…åµŒå®šä¹‰äº†ä½†æ˜¯åªç”¨åˆ°ä¸€æ¬¡çš„å˜é‡</span>
          collapse_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment">// æå–å‡ºå‡ºç°å¤šæ¬¡ä½†æ˜¯æ²¡æœ‰å®šä¹‰æˆå˜é‡å»å¼•ç”¨çš„é™æ€å€¼</span>
          reduce_vars<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>ModuleConcatenationPlugin(å¼€å¯ scope hosting æ”¯æŒ, ç”Ÿäº§æ¨¡å¼é»˜è®¤å€¼)</p> <p>å¯¹äºä½¿ç”¨ ES6 çš„ä»£ç ,åˆ†æå‡ºæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå°½å¯èƒ½çš„æŠŠæ‰“æ•£çš„æ¨¡å—åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­å»ï¼Œä½†å‰ææ˜¯ä¸èƒ½é€ æˆä»£ç å†—ä½™ã€‚ å› æ­¤åªæœ‰é‚£äº›è¢«å¼•ç”¨äº†ä¸€æ¬¡çš„æ¨¡å—æ‰èƒ½è¢«åˆå¹¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ModuleConcatenationPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack/lib/optimize/ModuleConcatenationPlugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// é’ˆå¯¹ Npm ä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—ä¼˜å…ˆé‡‡ç”¨ jsnext:main ä¸­æŒ‡å‘çš„ ES6 æ¨¡å—åŒ–è¯­æ³•çš„æ–‡ä»¶</span>
    mainFields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'jsnext:main'</span><span class="token punctuation">,</span> <span class="token string">'browser'</span><span class="token punctuation">,</span> <span class="token string">'main'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// å¼€å¯ Scope Hoisting</span>
    <span class="token keyword">new</span> <span class="token class-name">ModuleConcatenationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>webpack.DefinePlugin(å®šä¹‰ç¯å¢ƒå˜é‡)</p> <p>è¯¥æ’ä»¶ç”¨äºæ›¿æ¢ä»£ç ä¸­çš„éƒ¨åˆ†å­—æ®µ,ä¾‹å¦‚å®šä¹‰äº†ä¸‹é¢ä»£ç ä¸­çš„æ–¹å¼,é‚£ä¹ˆåœ¨å®¢æˆ·ç«¯ä¸­é‡åˆ° process.env.NODE_ENV å°±ä¼šè¢«æ›¿æ¢æˆåé¢çš„å€¼(webpack.DefinePlugin å°†æ›¿æ¢ process.env.NODE_ENV ä¸ºæ‚¨å®šä¹‰çš„ development)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'process.env'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'&quot;development&quot;'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token constant">PRODUCTION</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">VERSION</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'5fa3b9'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">BROWSER_SUPPORTS_HTML5</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token constant">TWO</span><span class="token operator">:</span> <span class="token string">'1+1'</span><span class="token punctuation">,</span>
  <span class="token string">'typeof window'</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'object'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>DefinePlugin</code>å¯èƒ½ä¼šè¢«è¯¯è®¤ä¸ºå…¶ä½œç”¨æ˜¯åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­ä¸ºç¼–è¯‘åçš„ä»£ç ä¸Šä¸‹æ–‡ç¯å¢ƒè®¾ç½®å…¨å±€å˜é‡ï¼Œä½†å…¶å®ä¸ç„¶ã€‚</p> <p>å®ƒçœŸæ­£çš„æœºåˆ¶æ˜¯ï¼š<code>DefinePlugin</code> çš„å‚æ•°æ˜¯ä¸€ä¸ª objectï¼Œé‚£ä¹ˆå…¶ä¸­ä¼šæœ‰ä¸€äº› key-value å¯¹ã€‚åœ¨ webpack ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šæŠŠä¸šåŠ¡ä»£ç ä¸­æ²¡æœ‰å®šä¹‰ï¼ˆä½¿ç”¨ <code>var/const/let</code> æ¥é¢„å®šä¹‰çš„ï¼‰è€Œå˜é‡ååˆä¸ key ç›¸åŒçš„å˜é‡ï¼ˆç›´æ¥è¯»ä»£ç çš„è¯çš„ç¡®åƒæ˜¯å…¨å±€å˜é‡ï¼‰æ›¿æ¢æˆ valueã€‚</p> <p>ä¾‹å¦‚ä¸Šé¢çš„å®˜æ–¹ä¾‹å­ï¼ŒPRODUCTION å°±ä¼šè¢«æ›¿æ¢ä¸º trueï¼›VERSION å°±ä¼šè¢«æ›¿æ¢ä¸º'5fa3b9'ï¼ˆæ³¨æ„å•å¼•å·ï¼‰ï¼›BROWSER_SUPPORTS_HTML5 ä¹Ÿæ˜¯ä¼šè¢«æ›¿æ¢ä¸º trueï¼›TWO ä¼šè¢«æ›¿æ¢ä¸º 1+1ï¼ˆç›¸å½“äºæ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼‰ï¼›typeof window å°±è¢«æ›¿æ¢ä¸º'object'äº†ã€‚</p> <p>å†ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä½ åœ¨ä»£ç é‡Œæ˜¯è¿™ä¹ˆå†™çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">PRODUCTION</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Debug info'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">PRODUCTION</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Production log'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é‚£ä¹ˆåœ¨ç¼–è¯‘ç”Ÿæˆçš„ä»£ç é‡Œå°±ä¼šæ˜¯è¿™æ ·äº†ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token boolean">true</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Debug info'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Production log'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è€Œå¦‚æœä½ ç”¨äº† UglifyJsPluginï¼Œåˆ™ä¼šå˜æˆè¿™æ ·ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Production log'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>terser-webpack-plugin</p> <p><a href="https://github.com/webpack-contrib/terser-webpack-plugin" target="_blank" rel="noopener noreferrer">terser-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ˜¯ä¸€ä¸ªä½¿ç”¨ terser å‹ç¼© js çš„ webpack æ’ä»¶</p> <p>å‹ç¼©æ˜¯å‘å¸ƒå‰å¤„ç†æœ€è€—æ—¶é—´çš„ä¸€ä¸ªæ­¥éª¤ï¼Œå¦‚æœæ˜¯ä½ æ˜¯åœ¨ webpack 4 ä¸­ï¼Œåªè¦å‡ è¡Œä»£ç ï¼Œå³å¯åŠ é€Ÿä½ çš„æ„å»ºå‘å¸ƒé€Ÿåº¦</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// å¤šçº¿ç¨‹</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <hr> <h2 id="å¸¸ç”¨ä¼˜åŒ–æ‰‹æ®µ"><a href="#å¸¸ç”¨ä¼˜åŒ–æ‰‹æ®µ" class="header-anchor">#</a> å¸¸ç”¨ä¼˜åŒ–æ‰‹æ®µ</h2> <p>webpack çš„ä¼˜åŒ–æ‰‹æ®µä¸»è¦ä»ä¸¤ä¸ªæ–¹å‘æ¥è¿›è¡Œ:</p> <ol><li>å‡å°‘ Webpack çš„æ‰“åŒ…æ—¶é—´</li> <li>å‡å° Webpack æ‰“åŒ…ä½“ç§¯</li></ol> <h3 id="å‡å°‘æ‰“åŒ…æ—¶é—´ç­–ç•¥"><a href="#å‡å°‘æ‰“åŒ…æ—¶é—´ç­–ç•¥" class="header-anchor">#</a> å‡å°‘æ‰“åŒ…æ—¶é—´ç­–ç•¥</h3> <ul><li>ç¼©å°æœç´¢èŒƒå›´</li></ul> <p>webpack çš„å„ç§è·¯å¾„æœç´¢é€’å½’æŸ¥æ‰¾å¾ˆè€—æ—¶é—´,å› æ­¤å¯¹éƒ¨åˆ†é€‰é¡¹è¿›è¡Œæ˜ç¡®çš„è·¯å¾„é…ç½®,å‡å°‘æœç´¢æ—¶é—´</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç”±äº Loader å¯¹æ–‡ä»¶çš„è½¬æ¢æ“ä½œå¾ˆè€—æ—¶ï¼Œéœ€è¦è®©å°½å¯èƒ½å°‘çš„æ–‡ä»¶è¢« Loader å¤„ç†,å¯ä»¥é€šè¿‡ include å»å‘½ä¸­åªæœ‰å“ªäº›æ–‡ä»¶éœ€è¦è¢«å¤„ç†ã€‚</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">//ä¸€äº›åº“ï¼Œä¾‹å¦‚ jQuery ã€ChartJSï¼Œ å®ƒä»¬åºå¤§åˆæ²¡æœ‰é‡‡ç”¨æ¨¡å—åŒ–æ ‡å‡†ï¼Œè®© Webpack å»è§£æè¿™äº›æ–‡ä»¶è€—æ—¶åˆæ²¡æœ‰æ„ä¹‰</span>
    noParse<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex">/react\.min\.js$/</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/* 
    resolve.modules çš„é»˜è®¤å€¼æ˜¯ ['node_modules']ï¼Œå«ä¹‰æ˜¯å…ˆå»å½“å‰ç›®å½•ä¸‹çš„ ./node_modules ç›®å½•ä¸‹å»æ‰¾æƒ³æ‰¾çš„æ¨¡å—ï¼Œå¦‚æœæ²¡æ‰¾åˆ°å°±å»ä¸Šä¸€çº§ç›®å½• ../node_modules ä¸­æ‰¾ï¼Œå†æ²¡æœ‰å°±å» ../../node_modules ä¸­æ‰¾ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿™å’Œ Node.js çš„æ¨¡å—å¯»æ‰¾æœºåˆ¶å¾ˆç›¸ä¼¼ã€‚
  
    å½“å®‰è£…çš„ç¬¬ä¸‰æ–¹æ¨¡å—éƒ½æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ ./node_modules ç›®å½•ä¸‹æ—¶ï¼Œæ²¡æœ‰å¿…è¦æŒ‰ç…§é»˜è®¤çš„æ–¹å¼å»ä¸€å±‚å±‚çš„å¯»æ‰¾ï¼Œå¯ä»¥æŒ‡æ˜å­˜æ”¾ç¬¬ä¸‰æ–¹æ¨¡å—çš„ç»å¯¹è·¯å¾„ï¼Œä»¥å‡å°‘å¯»æ‰¾ï¼Œé…ç½®å¦‚ä¸‹
    */</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// å…¥å£æ–‡ä»¶é…ç½®</span>
    mainFields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'main'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">/* é»˜è®¤æƒ…å†µä¸‹ Webpack ä¼šä»å…¥å£æ–‡ä»¶ ./node_modules/react/react.js å¼€å§‹é€’å½’çš„è§£æå’Œå¤„ç†ä¾èµ–çš„å‡ åä¸ªæ–‡ä»¶ï¼Œè¿™ä¼šæ—¶ä¸€ä¸ªè€—æ—¶çš„æ“ä½œã€‚ é€šè¿‡é…ç½® resolve.alias å¯ä»¥è®© Webpack åœ¨å¤„ç† React åº“æ—¶ï¼Œç›´æ¥ä½¿ç”¨å•ç‹¬å®Œæ•´çš„ react.min.js æ–‡ä»¶ï¼Œä»è€Œè·³è¿‡è€—æ—¶çš„é€’å½’è§£ææ“ä½œ */</span>
      react<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./node_modules/dist/react.min.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/*  å¦‚æœè¿™ä¸ªåˆ—è¡¨è¶Šé•¿ï¼Œæˆ–è€…æ­£ç¡®çš„åç¼€åœ¨è¶Šåé¢ï¼Œå°±ä¼šé€ æˆå°è¯•çš„æ¬¡æ•°è¶Šå¤šï¼Œæ‰€ä»¥ resolve.extensions çš„é…ç½®ä¹Ÿä¼šå½±å“åˆ°æ„å»ºçš„æ€§èƒ½ã€‚ åœ¨é…ç½® resolve.extensions æ—¶ä½ éœ€è¦éµå®ˆä»¥ä¸‹å‡ ç‚¹ï¼Œä»¥åšåˆ°å°½å¯èƒ½çš„ä¼˜åŒ–æ„å»ºæ€§èƒ½ï¼š
  
      åç¼€å°è¯•åˆ—è¡¨è¦å°½å¯èƒ½çš„å°ï¼Œä¸è¦æŠŠé¡¹ç›®ä¸­ä¸å¯èƒ½å­˜åœ¨çš„æƒ…å†µå†™åˆ°åç¼€å°è¯•åˆ—è¡¨ä¸­ã€‚
      é¢‘ç‡å‡ºç°æœ€é«˜çš„æ–‡ä»¶åç¼€è¦ä¼˜å…ˆæ”¾åœ¨æœ€å‰é¢ï¼Œä»¥åšåˆ°å°½å¿«çš„é€€å‡ºå¯»æ‰¾è¿‡ç¨‹ã€‚
      åœ¨æºç ä¸­å†™å¯¼å…¥è¯­å¥æ—¶ï¼Œè¦å°½å¯èƒ½çš„å¸¦ä¸Šåç¼€ï¼Œä»è€Œå¯ä»¥é¿å…å¯»æ‰¾è¿‡ç¨‹ã€‚ä¾‹å¦‚åœ¨ä½ ç¡®å®šçš„æƒ…å†µä¸‹æŠŠ require('./data') å†™æˆ require('./data.json')ã€‚ */</span>
    extension<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>ä½¿ç”¨å¤šè¿›ç¨‹åŠ é€Ÿ loader</li></ul> <p>åœ¨ webpack æ„å»ºçš„è¿‡ç¨‹ä¸­,æœ€è€—æ—¶çš„æ“ä½œå°±æ˜¯ loader å¤„ç†æ–‡ä»¶è¿™ä¸€æ­¥,
å—é™äº Node æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œæ‰€ä»¥ Webpack åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨æ‰§è¡Œ Loader çš„æ—¶å€™ï¼Œé•¿æ—¶é—´ç¼–è¯‘çš„ä»»åŠ¡å¾ˆå¤šï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç­‰å¾…çš„æƒ…å†µã€‚</p> <p>HappyPack å¯ä»¥å°† Loader çš„åŒæ­¥æ‰§è¡Œè½¬æ¢ä¸ºå¹¶è¡Œçš„ï¼Œè¿™æ ·å°±èƒ½å……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºæ¥åŠ å¿«æ‰“åŒ…æ•ˆç‡äº†</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
      include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
      <span class="token comment">// id åé¢çš„å†…å®¹å¯¹åº”ä¸‹é¢</span>
      loader<span class="token operator">:</span> <span class="token string">'happypack/loader?id=happybabel'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'happybabel'</span><span class="token punctuation">,</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// å¼€å¯ 4 ä¸ªçº¿ç¨‹</span>
    threads<span class="token operator">:</span> <span class="token number">4</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><ul><li>ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ DllPlugin</li></ul> <div class="custom-block warning"><p class="custom-block-title">æ³¨æ„:</p> <p>ä¸»è¦ç”¨äºå¼€å‘ç¯å¢ƒ</p></div> <p>DllPlugin å¯ä»¥å°†ç‰¹å®šçš„ç±»åº“æå‰æ‰“åŒ…ç„¶åå¼•å…¥ã€‚è¿™ç§æ–¹å¼å¯ä»¥æå¤§çš„å‡å°‘æ‰“åŒ…ç±»åº“çš„æ¬¡æ•°ï¼Œåªæœ‰å½“ç±»åº“æ›´æ–°ç‰ˆæœ¬æ‰æœ‰éœ€è¦é‡æ–°æ‰“åŒ…ï¼Œå¹¶ä¸”ä¹Ÿå®ç°äº†å°†å…¬å…±ä»£ç æŠ½ç¦»æˆå•ç‹¬æ–‡ä»¶çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨ DllPlugin</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å•ç‹¬é…ç½®åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­</span>
<span class="token comment">// webpack.dll.conf.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// æƒ³ç»Ÿä¸€æ‰“åŒ…çš„ç±»åº“</span>
    vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">'[name]-[hash]'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// name å¿…é¡»å’Œ output.library ä¸€è‡´</span>
      name<span class="token operator">:</span> <span class="token string">'[name]-[hash]'</span><span class="token punctuation">,</span>
      <span class="token comment">// è¯¥å±æ€§éœ€è¦ä¸ DllReferencePlugin ä¸­ä¸€è‡´</span>
      context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'[name]-manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ç„¶åæˆ‘ä»¬éœ€è¦æ‰§è¡Œè¿™ä¸ªé…ç½®æ–‡ä»¶ç”Ÿæˆä¾èµ–æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ DllReferencePlugin å°†ä¾èµ–æ–‡ä»¶å¼•å…¥é¡¹ç›®ä¸­</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.conf.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...çœç•¥å…¶ä»–é…ç½®</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
      <span class="token comment">// manifest å°±æ˜¯ä¹‹å‰æ‰“åŒ…å‡ºæ¥çš„ json æ–‡ä»¶</span>
      manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/vendor-manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>babel-loader è®¾ç½®ç¼“å­˜</li></ul> <blockquote><p>è®¾ç½® babel çš„ cacheDirectory ä¸º true</p></blockquote> <p>babel ç¼–è¯‘ä»£ç çš„è¿‡ç¨‹å¤ªæ…¢äº†,ä¸ä»…è¦ä½¿ç”¨ excludeã€includeï¼Œå°½å¯èƒ½å‡†ç¡®çš„æŒ‡å®šè¦è½¬åŒ–å†…å®¹çš„èŒƒç•´ï¼Œè€Œä¸”è¦å……åˆ†åˆ©ç”¨ç¼“å­˜ï¼Œè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚babel-loader æä¾›äº† cacheDirectory ç‰¹å®šé€‰é¡¹ï¼ˆé»˜è®¤ falseï¼‰ï¼šè®¾ç½®æ—¶ï¼Œç»™å®šçš„ç›®å½•å°†ç”¨äºç¼“å­˜åŠ è½½å™¨çš„ç»“æœ</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'babel-loader?cacheDirectory=true'</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>ä½¿ç”¨ terser-webpack-plugin åŠ é€Ÿä»£ç å‹ç¼©</li></ul> <div class="custom-block warning"><p class="custom-block-title">æ³¨æ„:</p> <p>webpack4 ä½¿ç”¨ <a href="https://github.com/webpack-contrib/terser-webpack-plugin" target="_blank" rel="noopener noreferrer">terser-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>webpack3 ä½¿ç”¨ <a href="https://github.com/gdborton/webpack-parallel-uglify-plugin#readme" target="_blank" rel="noopener noreferrer">webpack-parallel-uglify-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>è¯¥æ’ä»¶ä¸»è¦ç”¨äºçº¿ä¸Šç¯å¢ƒ</p></div> <p>å‹ç¼©æ˜¯å‘å¸ƒå‰å¤„ç†æœ€è€—æ—¶é—´çš„ä¸€ä¸ªæ­¥éª¤ï¼Œå› æ­¤ä¹Ÿéœ€è¦é‡‡ç”¨å¹¶è¡Œå¤šè¿›ç¨‹çš„æ–¹å¼æ¥å¼€å¯åŠ é€Ÿ,å¦‚æœæ˜¯ä½ æ˜¯åœ¨ webpack 4 ä¸­ï¼Œåªè¦å‡ è¡Œä»£ç ï¼Œå³å¯åŠ é€Ÿä½ çš„æ„å»ºå‘å¸ƒé€Ÿåº¦</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment">//æˆ–è€…ä½¿ç”¨ugifyjså¼€å¯parallel</span>
    <span class="token comment">/* minimizer: [
      new UglifyJsPlugin({
        include: /\/includes/,
        parallel: true // æˆ–è€…å†™æ ¸å¿ƒæ•°
      })
    ] */</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>å¼€å‘ç¯å¢ƒå¼€å¯çƒ­æ›´æ–°</li></ul> <p>ä¸ºäº†åŠ é€Ÿæœ¬åœ°å¼€å‘ç¯å¢ƒçš„æ„å»ºé€Ÿåº¦, å¼€å¯çƒ­æ¨¡å—æ›¿æ¢èƒ½èŠ‚çœæ›´å¤šçš„æ—¶é—´,åœ¨ webpack ä¸­åªéœ€è¦å¼€å¯ devServer çš„ hot é€‰é¡¹; æ­¤æ—¶ webpack.HotModuleReplacementPlugin è‡ªåŠ¨ä¼šæ·»åŠ åˆ° webpack ä¸­</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å‡å°æ‰“åŒ…ä½“ç§¯ç­–ç•¥"><a href="#å‡å°æ‰“åŒ…ä½“ç§¯ç­–ç•¥" class="header-anchor">#</a> å‡å°æ‰“åŒ…ä½“ç§¯ç­–ç•¥</h3> <ul><li>ä½¿ç”¨æŒ‰éœ€åŠ è½½</li></ul> <p>ä¸€èˆ¬æŒ‰éœ€åŠ è½½éƒ½æ˜¯ PWA é¡µé¢è·¯ç”±çš„æ‡’åŠ è½½,ä½¿ç”¨ esmodule çš„ import()æ¥è¿›è¡ŒåŠ è½½, æ­¤å¤„ä½¿ç”¨ vue çš„è·¯ç”±é…ç½®ä½œä¸ºç¤ºä¾‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¦‚æœæ˜¯é¦–é¡µå¯ä»¥å¼€å¯preloadé€‰é¡¹æ¥åŠ é€Ÿæ˜¾ç¤º</span>
<span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">'æ¸©é¦¨æç¤º'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span>
    <span class="token comment">/* webpackChunkName: &quot;index&quot; */</span>
    <span class="token comment">/* webpackPreload: true */</span>
    <span class="token string">'./views/index.vue'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>ä½¿ç”¨ä½œç”¨åŸŸæå‡ Scope Hoisting</li></ul> <p>Scope Hoisting å°½å¯èƒ½çš„æŠŠæ‰“æ•£çš„æ¨¡å—åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­å»ï¼Œä½†å‰ææ˜¯ä¸èƒ½é€ æˆä»£ç å†—ä½™ã€‚ å› æ­¤åªæœ‰é‚£äº›è¢«å¼•ç”¨äº†ä¸€æ¬¡çš„æ¨¡å—æ‰èƒ½è¢«åˆå¹¶,ä»è€Œå‡å°äº†ä»£ç ä½“ç§¯</p> <p>åœ¨ webpack4 åªéœ€è¦å¼€å¯é€‰é¡¹ <code>concatenateModules</code> å³å¯</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    concatenateModules<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>ä½¿ç”¨ Tree Shaking</li></ul> <div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>webpack 4 æ­£å¼ç‰ˆæœ¬æ‰©å±•äº†å‰¯ä½œç”¨æ£€æµ‹èƒ½åŠ›ï¼Œé€šè¿‡ <code>package.json</code> çš„ <code>&quot;sideEffects&quot;</code> å±æ€§ä½œä¸ºæ ‡è®°ï¼Œå‘ compiler æä¾›æç¤ºï¼Œè¡¨æ˜é¡¹ç›®ä¸­çš„å“ªäº›æ–‡ä»¶æ˜¯ &quot;pure(çº¯çš„ ES2015 æ¨¡å—)&quot;ï¼Œç”±æ­¤å¯ä»¥å®‰å…¨åœ°åˆ é™¤æ–‡ä»¶ä¸­æœªä½¿ç”¨çš„éƒ¨åˆ†ã€‚ä½¿ç”¨ <code>Tree Shaking</code>, åº”è¯¥æ˜ç¡®æ ‡è¯†å‡ºä»£ç çš„ <code>sideEffects</code></p></div> <p>sideEffects é…ç½®å¦‚ä¸‹</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;your-project&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/some-side-effectful-file.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// æ— å‰¯ä½œç”¨ç›´æ¥è®¾ç½®ä¸ºfalse</span>
  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>TreeShaing çš„å¼€å¯å¦‚ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    usedExports<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    sideEffects<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// æœ‰å‰¯ä½œç”¨æ—¶æ­¤å¤„ä¹Ÿè¦é…ç½®ä¸ºtrue</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>å‹ç¼©ä»£ç </li></ul> <p>webpack4 é…ç½®æ–¹å¼éœ€è¦åªéœ€è¦å¼€å¯ minimizer é€‰é¡¹å³å¯</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UglifyJsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'uglifyjs-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        include<span class="token operator">:</span> <span class="token regex">/\/includes/</span><span class="token punctuation">,</span>
        parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sourceMap<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//ä½¿ç”¨æºæ˜ å°„å°†é”™è¯¯æ¶ˆæ¯ä½ç½®æ˜ å°„åˆ°æ¨¡å—</span>
        cache<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//å¯ç”¨æ–‡ä»¶ç¼“å­˜</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>æå–å…¬å…±ä»£ç </li></ul> <p>å¤šä¸ªé¡µé¢å…¬å…±çš„ä»£ç æŠ½ç¦»æˆå•ç‹¬çš„æ–‡ä»¶, å¯ä»¥å‡å°‘ç½‘ç»œä¼ è¾“æµé‡ï¼Œé™ä½æœåŠ¡å™¨æˆæœ¬,ä¹Ÿè§£å†³äº†é‡å¤ä»£ç å¯¼è‡´çš„åŒ…ä½“ç§¯å˜å¤§, å†åŠ ä¸Šç¼“å­˜ç­–ç•¥;èƒ½å¤ŸåŠ é€Ÿé¡µé¢åŠ è½½é€Ÿåº¦</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      chunks<span class="token operator">:</span> <span class="token string">'async'</span><span class="token punctuation">,</span>
      minSize<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
      maxSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      maxInitialRequests<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      automaticNameDelimiter<span class="token operator">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendors<span class="token operator">:</span> <span class="token punctuation">{</span>
          test<span class="token operator">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>
          reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>ä½¿ç”¨ prepack</li></ul> <div class="custom-block warning"><p class="custom-block-title">è­¦å‘Š</p> <p>è¯¥åŠŸèƒ½ä»ç„¶æ˜¯å®éªŒæ€§çš„, åœ¨ç”Ÿäº§ç¯å¢ƒä¸å»ºè®®ä½¿ç”¨</p></div> <p>ç›´æ¥ä¸Šä»£ç å§</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> PrepackWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'prepack-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">PrepackWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>æ‹·è´é™æ€æ–‡ä»¶</li></ul> <p>åœ¨å‰æ–‡ Webpack æ‰“åŒ…ä¼˜åŒ–ä¹‹ä½“ç§¯ç¯‡ä¸­æåˆ°ï¼Œå¼•å…¥ DllPlugin å’Œ DllReferencePlugin æ¥æå‰æ„å»ºä¸€äº›ç¬¬ä¸‰æ–¹åº“ï¼Œæ¥ä¼˜åŒ– Webpack æ‰“åŒ…ã€‚è€Œåœ¨ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œå°±éœ€è¦å°†æå‰æ„å»ºå¥½çš„åŒ…ï¼ŒåŒæ­¥åˆ° dist ä¸­ï¼›è¿™é‡Œæ‹·è´é™æ€æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ copy-webpack-plugin æ’ä»¶ï¼šæŠŠæŒ‡å®šæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å¤åˆ¶åˆ°æŒ‡å®šçš„ç›®å½•ï¼›å…¶é…ç½®å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ......</span>
    <span class="token comment">// copy custom static assets</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">from</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../static'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        to<span class="token operator">:</span> config<span class="token punctuation">.</span>build<span class="token punctuation">.</span>assetsSubDirectory<span class="token punctuation">,</span>
        ignore<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.*'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="æ ¸å¿ƒé€‰é¡¹-optimization"><a href="#æ ¸å¿ƒé€‰é¡¹-optimization" class="header-anchor">#</a> æ ¸å¿ƒé€‰é¡¹ optimization</h2> <p>optimization åŒ…å«äº† webpack å…³é”®çš„ä¼˜åŒ–é…ç½®é€‰é¡¹, ä»¥ä¸‹å‡ ä¸ªé€‰é¡¹è·Ÿæµè§ˆå™¨ç¼“å­˜æ¯æ¯ç›¸å…³, æ­¤å¤„åšä¸€ä¸ªè®°å½•</p> <ul><li><p><code>namedModules</code>:</p> <p>åœ¨å¼€å‘ç¯å¢ƒçš„æ‰“åŒ…ç»“æœä¸­,ä½¿ç”¨è·¯å¾„ä½œä¸ºæ¨¡å—çš„åç§°, å›ºåŒ– moduleId</p></li> <li><p><code>namedChunks</code>:</p> <p>åœ¨å¼€å‘ç¯å¢ƒçš„æ‰“åŒ…ç»“æœä¸­,å›ºåŒ– runtime ä»£ç ä»¥åŠåŠ¨æ€åŠ è½½æ—¶åˆ†ç¦»å‡ºçš„ chunk çš„ chunkId</p></li> <li><p><code>moduleIds</code>:</p> <p>ç”Ÿäº§ç¯å¢ƒå›ºåŒ– moduleId</p> <table><thead><tr><th>é€‰é¡¹</th> <th>æè¿°</th></tr></thead> <tbody><tr><td>natural</td> <td>æŒ‰ä½¿ç”¨é¡ºåºçš„æ•°å­— ID</td></tr> <tr><td>named</td> <td>å¯è¯»çš„ IDï¼Œä»¥è¿›è¡Œæ›´å¥½çš„è°ƒè¯•ã€‚</td></tr> <tr><td>hashed</td> <td>çŸ­å“ˆå¸Œä½œä¸º idï¼Œå¯ä»¥æ›´å¥½åœ°è¿›è¡Œé•¿æœŸç¼“å­˜</td></tr> <tr><td>size</td> <td>æ•°å­— ID ä¸“æ³¨äºæœ€å°çš„åˆå§‹ä¸‹è½½å¤§å°</td></tr> <tr><td>total-size</td> <td>æ•°å­— ID ä¸“æ³¨äºæœ€å°çš„æ€»ä¸‹è½½å¤§å°</td></tr></tbody></table></li> <li><p><code>chunkIds</code>:</p> <p>ç”Ÿäº§ç¯å¢ƒå›ºåŒ– runtime å’Œå¼‚æ­¥ä»£ç  chunkId</p> <p>é€‰é¡¹å‚ç…§<code>moduleIds</code>çš„é…ç½®é¡¹</p></li> <li><p><code>nodeEnv</code>:</p> <p>webpack å°† process.env.NODE_ENV è®¾ç½®ä¸ºä¸€ä¸ªç»™å®šçš„å­—ç¬¦ä¸²ã€‚å¦‚æœ optimization.nodeEnv ä¸æ˜¯ falseï¼Œå¯ä»¥ä½¿ç”¨ DefinePluginï¼Œé…ç½®ä¸º optimization.nodeEnv çš„å€¼ï¼Œå¦‚æœä¸º falsy å€¼ï¼Œå¯ä»¥è¿”å›é€€åˆ°&quot;production&quot;</p></li></ul> <h2 id="éƒ¨åˆ†ç–‘æƒ‘é€‰é¡¹è®°å½•"><a href="#éƒ¨åˆ†ç–‘æƒ‘é€‰é¡¹è®°å½•" class="header-anchor">#</a> éƒ¨åˆ†ç–‘æƒ‘é€‰é¡¹è®°å½•</h2> <ul><li>include/exclude/test çš„åŒºåˆ«</li></ul> <blockquote><p><strong>test</strong>ï¼šå¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸è¦åŠ å¼•å·ï¼ŒåŒ¹é…è¦å¤„ç†çš„æ–‡ä»¶ï¼‰
<strong>exclude</strong>ï¼šä¸èƒ½æ»¡è¶³çš„æ¡ä»¶ï¼ˆæ’é™¤ä¸å¤„ç†çš„ç›®å½•ï¼‰
<strong>include</strong>ï¼šå¯¼å…¥çš„æ–‡ä»¶å°†ç”±åŠ è½½ç¨‹åºè½¬æ¢çš„è·¯å¾„æˆ–æ–‡ä»¶æ•°ç»„ï¼ˆæŠŠè¦å¤„ç†çš„ç›®å½•åŒ…æ‹¬è¿›æ¥ï¼‰
<strong>loader</strong>ï¼šä¸€ä¸²â€œï¼â€åˆ†éš”çš„è£…è½½æœºï¼ˆ2.0 ç‰ˆæœ¬ä»¥ä¸Šï¼Œâ€-loaderâ€ä¸å¯ä»¥çœç•¥ï¼‰
<strong>loaders</strong>ï¼šä½œä¸ºå­—ç¬¦ä¸²çš„è£…è½½å™¨é˜µåˆ—</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
      rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token comment">// &quot;test&quot; is commonly used to match the file extension</span>
          test<span class="token operator">:</span> <span class="token regex">/\.jsx$/</span><span class="token punctuation">,</span>

          <span class="token comment">// &quot;include&quot; is commonly used to match the directories</span>
          include<span class="token operator">:</span> <span class="token punctuation">[</span>
            path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;app/src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;app/test&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token comment">// &quot;exclude&quot; should be used to exclude exceptions</span>
          <span class="token comment">// try to prefer &quot;include&quot; when possible</span>

          <span class="token comment">// the &quot;loader&quot;</span>
          loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span> <span class="token comment">// or &quot;babel&quot; because webpack adds the '-loader' automatically</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><ul><li>output é€‰é¡¹çš„ chunkFilename</li></ul> <blockquote><p>ä½œç”¨: é…ç½®æ— å…¥å£çš„ Chunk åœ¨è¾“å‡ºæ—¶çš„æ–‡ä»¶åç§°</p></blockquote> <p>å¸¸è§çš„ä¼šåœ¨è¿è¡Œæ—¶ç”Ÿæˆ Chunk åœºæ™¯æœ‰åœ¨ä½¿ç”¨ CommonChunkPluginã€ä½¿ç”¨ import('path/to/module') åŠ¨æ€åŠ è½½ç­‰æ—¶ã€‚ chunkFilename æ”¯æŒå’Œ filename ä¸€è‡´çš„å†…ç½®å˜é‡</p> <ul><li>splitChunks ä¸ dllplugin çš„åŒºåˆ«:</li></ul> <blockquote><p>éƒ½æ˜¯æå–å…¬å…±ä»£ç æ’ä»¶</p></blockquote> <p>æ€»è€Œè¨€ä¹‹ï¼Œå®ƒä»¬çœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œä½†å®ƒä»¬å¯ä»¥è®©ä½ å‡»ä¸­ä¸åŒçš„ç›®æ ‡ã€‚è¿™ä¹ˆå¤šï¼Œä½ å¯ä»¥è€ƒè™‘åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ DllPluginï¼ˆä¼˜ç‚¹ï¼šç¼–è¯‘æ—¶é—´çŸ­ï¼‰ï¼ŒåŒæ—¶ä½¿ç”¨ splitChunks è¿›è¡Œç”Ÿäº§ï¼ˆä¼˜ç‚¹ï¼šapp æ›´æ”¹æ—¶çš„åŠ è½½æ—¶é—´çŸ­ï¼‰ã€‚åŒæ ·ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ DllPluginï¼Œåªéœ€è¦è¿ç»­è¿è¡Œä¸¤ä¸ªç‰ˆæœ¬çš„å°éº»çƒ¦ï¼šä¸€ä¸ªç”¨äº DLLï¼Œå¦ä¸€ä¸ªç”¨äºåº”ç”¨ç¨‹åºã€‚</p> <p>é™„ä¸Š stackoverflow ä¸­çš„<a href="https://stackoverflow.com/questions/41890855/webpack-common-chunks-plugin-vs-webpack-dll-plugin" target="_blank" rel="noopener noreferrer">åˆ†æè¿æ¥<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>output é€‰é¡¹ä¸­çš„[hash]ä»¥åŠ[chunkhash]</li></ul> <blockquote><p>chunkhash åªèƒ½ç”¨äºç”Ÿäº§ç¯å¢ƒ, è€Œ hash ä¸€èˆ¬ç”¨äºå¼€å‘ç¯å¢ƒ,å› ä¸º chunkhash ä¸ HMR å†²çª</p></blockquote> <ul><li>runtime &amp;&amp; manifest</li></ul> <blockquote><p><strong>runtime</strong>: å°±æ˜¯å¸®åŠ© webpack ç¼–è¯‘æ„å»ºåçš„æ‰“åŒ…æ–‡ä»¶åœ¨æµè§ˆå™¨è¿è¡Œçš„ä¸€äº›è¾…åŠ©ä»£ç æ®µï¼Œæ¢å¥è¯è¯´ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶ï¼Œé™¤äº†ä½ è‡ªå·±çš„æºç å’Œ npm åº“å¤–ï¼Œè¿˜æœ‰ webpack æä¾›çš„ä¸€ç‚¹è¾…åŠ©ä»£ç æ®µ</p></blockquote> <blockquote><p><strong>manifest</strong>: åˆ™æ˜¯ webpack ç”¨ä»¥æŸ¥æ‰¾ chunk çœŸå®è·¯å¾„æ‰€ä½¿ç”¨çš„ä¸€ä»½å…³ç³»è¡¨ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯ chunk åå¯¹åº” chunk è·¯å¾„çš„å…³ç³»è¡¨</p></blockquote> <h2 id="æ³¨å…¥å…¨å±€å˜é‡"><a href="#æ³¨å…¥å…¨å±€å˜é‡" class="header-anchor">#</a> æ³¨å…¥å…¨å±€å˜é‡</h2> <p>æ³¨å…¥å…¨å±€å˜é‡å¯ä»¥ä½¿ç”¨ä¸‰ç§é€”å¾„æ¥å®Œæˆ</p> <ul><li><p>ProvidePlugin</p></li> <li><p>exposed-loader</p></li></ul> <p>é‚£ä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢?</p> <h3 id="provideplugin"><a href="#provideplugin" class="header-anchor">#</a> ProvidePlugin</h3> <p>ProvidePlugin ç”¨æ¥è‡ªåŠ¨åŠ è½½æ¨¡å—ï¼Œè€Œä¸å¿…åˆ°å¤„ import æˆ– require</p> <p>å®ƒçš„æœºåˆ¶æ˜¯å½“ webpack åŠ è½½åˆ°æŸä¸ª js æ¨¡å—é‡Œï¼Œå‡ºç°äº†æœªå®šä¹‰ä¸”åç§°ç¬¦åˆï¼ˆå­—ç¬¦ä¸²å®Œå…¨åŒ¹é…ï¼‰é…ç½®ä¸­ key çš„å˜é‡æ—¶ï¼Œä¼šè‡ªåŠ¨ require é…ç½®ä¸­ value æ‰€æŒ‡å®šçš„ js æ¨¡å—</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  $<span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span>
  jQuery<span class="token operator">:</span> <span class="token string">'jquery'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="exposed-loader"><a href="#exposed-loader" class="header-anchor">#</a> exposed-loader</h3> <p>çœ‹åç§°å¯ä»¥çŸ¥é“è¿™ä¸ªä¸€ä¸ªæš´éœ²å…¨å±€å˜é‡çš„ loader,å½“æŸä¸ª js æ¨¡å—æ˜¾å¼åœ°è°ƒç”¨ <code>import $ from 'jquery'</code>çš„æ—¶å€™ï¼Œå°±ä¼šå°†$æ³¨å…¥åˆ° window ä¸­</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'expose-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token string">'$'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨åº”ç”¨ä»£ç ä¸­ä½¿ç”¨</span>

<span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">'jquery'</span><span class="token punctuation">;</span>

<span class="token comment">// å°±èƒ½ç›´æ¥è¯»å–åˆ°window.$</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>html å·²ç»é€šè¿‡ script å¼•å…¥äº†ä¸€äº›å¤–éƒ¨ CDN æ¨¡å—(ä¾‹å¦‚ <code>vue.min.js</code>), åœ¨ä»£ç ä¸­å°±ä¸è¦å†æ¬¡å¼•å…¥</p> <p><code>import Vue from 'vue'</code></p> <p>åœ¨ webpack é…ç½®ä¸­, ä½¿ç”¨ external é€‰é¡¹,å°† Vue ç»™æ’é™¤åœ¨å¤–,ä»¥å…å¼•èµ·æ¨¡å—å¤šæ¬¡æ‰“åŒ…,ä½“ç§¯å¢å¤§</p></div> <h2 id="long-term-cache"><a href="#long-term-cache" class="header-anchor">#</a> Long Term Cache</h2> <p><code>webpack</code>çš„é•¿æ•ˆç¼“å­˜æ€»ç»“å¦‚ä¸‹:</p> <p><a href="http://naotu.baidu.com/file/1cb8b00b75453d162915f0296cc4c7c8?token=324bd0a3344353dd" target="_blank" rel="noopener noreferrer"><img src="https://wx2.sbimg.cn/2020/07/17/Cn08m.png" alt="é•¿æ•ˆç¼“å­˜è„‘å›¾"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="git-æäº¤é’©å­-husky-å’Œ-yorkie"><a href="#git-æäº¤é’©å­-husky-å’Œ-yorkie" class="header-anchor">#</a> Git æäº¤é’©å­(husky å’Œ yorkie)</h2> <p>husky å’Œ yorkie éƒ½æ˜¯æäº¤é’©å­, ä¸¤è€…åŒºåˆ«å‚è€ƒ<a href="https://segmentfault.com/a/1190000016750078" target="_blank" rel="noopener noreferrer">åŸæ–‡åœ°å€<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90" target="_blank" rel="noopener noreferrer">git é’©å­ä»‹ç»<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>å®¢æˆ·ç«¯é’©å­åŒ…æ‹¬ï¼špre-commitã€prepare-commit-msgã€commit-msgã€post-commit ç­‰ï¼Œä¸»è¦ç”¨äºæ§åˆ¶å®¢æˆ·ç«¯ git çš„æäº¤å·¥ä½œæµã€‚æœåŠ¡ç«¯é’©å­ï¼špre-receiveã€post-receiveã€updateï¼Œä¸»è¦åœ¨æœåŠ¡ç«¯æ¥æ”¶æäº¤å¯¹è±¡æ—¶ã€æ¨é€åˆ°æœåŠ¡å™¨ä¹‹å‰è°ƒç”¨</p></blockquote> <p><a href="https://github.com/typicode/husky" target="_blank" rel="noopener noreferrer">å…³äº husky<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>husky å¯ä»¥è®© git hooks çš„ä½¿ç”¨å˜å¾—æ›´ç®€å•æ–¹ä¾¿ã€‚è¿è¡Œ npm install husky@next --save-dev å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œå®ƒä¼šåœ¨æˆ‘ä»¬é¡¹ç›®æ ¹ç›®å½•ä¸‹é¢çš„.git/hooks æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»º pre-commitã€pre-push ç­‰ hooksã€‚è¿™äº› hooks å¯ä»¥è®©æˆ‘ä»¬ç›´æ¥åœ¨ package.json çš„ script é‡Œè¿è¡Œæˆ‘ä»¬æƒ³è¦åœ¨æŸä¸ª hook é˜¶æ®µæ‰§è¡Œçš„å‘½ä»¤</p></blockquote> <div class="custom-block warning"><p class="custom-block-title">husky ä½¿ç”¨æ³¨æ„</p> <p>husky å¯¹åº”å±æ€§åå·²ç»æ”¹ä¸º HUSKY_GIT_PARAMS , è€Œä¸æ˜¯åŸå§‹çš„ GIT_PARAMS ç¯å¢ƒå˜é‡</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
   <span class="token string">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token string">&quot;hooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token string">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token string">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token string">&quot;*.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;git add&quot;</span><span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://github.com/yyx990803/yorkie" target="_blank" rel="noopener noreferrer">å…³äº youkie<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>åœ¨ vue æœ€æ–°çš„ç‰ˆæœ¬ä¸­ï¼Œå·²ç»ä½¿ç”¨å°¤å¤§æ”¹å†™çš„ youkieï¼Œ youkie å®é™…æ˜¯ fork husky,ç„¶ååšäº†ä¸€äº›å®šåˆ¶åŒ–çš„æ”¹åŠ¨ï¼Œ ä½¿å¾—é’©å­èƒ½ä» package.json çš„ &quot;gitHooks&quot;å±æ€§ä¸­è¯»å–</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
 <span class="token string">&quot;gitHooks&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;pre-commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lint-staged&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;commit-msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node scripts/verify-commit-msg.js&quot;</span> <span class="token comment">//tæ¯”æäº¤ä¿¡æ¯æ£€æŸ¥ [è¿æ¥](https://github.com/vuejs/vue/blob/dev/scripts/verify-commit-msg.js)</span>
 <span class="token punctuation">}</span>
 <span class="token string">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;*.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token string">&quot;eslint --fix&quot;</span><span class="token punctuation">,</span>
     <span class="token string">&quot;git add&quot;</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">å…³äº lint-staged<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>åª lint å½“å‰æ”¹åŠ¨çš„æ–‡ä»¶ï¼Œlint-staged å°±éå¸¸å‡†ç¡®çš„è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œä»è¿™ä¸ªåŒ…åï¼Œå°±å¯ä»¥çœ‹å‡ºï¼ŒRun linters on git staged filesï¼Œåªé’ˆå¯¹æ”¹åŠ¨çš„æ–‡ä»¶è¿›è¡Œå¤„ç†</p></blockquote> <hr></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æ›´æ–°æ—¶é—´:</span> <span class="time">7/17/2020, 4:59:25 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/skills/ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°.html" class="prev">
        ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°
      </a></span> <span class="next"><a href="/blog/skills/Webpackæ¨¡å—å®ç°.html">
        Webpack æ¨¡å—å®ç°
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.b45d52a8.js" defer></script><script src="/blog/assets/js/3.ab657a59.js" defer></script><script src="/blog/assets/js/27.1270bbeb.js" defer></script><script src="/blog/assets/js/4.022282fe.js" defer></script>
  </body>
</html>

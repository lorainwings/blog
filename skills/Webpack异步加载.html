<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack å¼‚æ­¥åŠ è½½ | Lorain&#39;s ä¸ªäººä¸»é¡µğŸ–Œ</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/base/hd-img.jpg">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/base/hd-img.jpg">
    <meta name="description" content="å±±ä¸­æ¨—æ å¹´å¹´åœ¨ & çœ‹å°½è¥¿é£æœ¨æ§¿èŠ±">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/blog/assets/css/0.styles.4a9580f2.css" as="style"><link rel="preload" href="/blog/assets/js/app.b9d1aa2a.js" as="script"><link rel="preload" href="/blog/assets/js/3.8c44ca0e.js" as="script"><link rel="preload" href="/blog/assets/js/33.6665e618.js" as="script"><link rel="preload" href="/blog/assets/js/4.57980df9.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.930d1339.js"><link rel="prefetch" href="/blog/assets/js/11.cdeb8098.js"><link rel="prefetch" href="/blog/assets/js/12.c8cde42b.js"><link rel="prefetch" href="/blog/assets/js/13.a227fbb7.js"><link rel="prefetch" href="/blog/assets/js/14.6af4650a.js"><link rel="prefetch" href="/blog/assets/js/15.6eaa9661.js"><link rel="prefetch" href="/blog/assets/js/16.061f9c22.js"><link rel="prefetch" href="/blog/assets/js/17.45db52d8.js"><link rel="prefetch" href="/blog/assets/js/18.f048e80a.js"><link rel="prefetch" href="/blog/assets/js/19.cb4e044a.js"><link rel="prefetch" href="/blog/assets/js/20.7f19d52d.js"><link rel="prefetch" href="/blog/assets/js/21.d8589558.js"><link rel="prefetch" href="/blog/assets/js/22.f566dc38.js"><link rel="prefetch" href="/blog/assets/js/23.b69d67c8.js"><link rel="prefetch" href="/blog/assets/js/24.39640fa3.js"><link rel="prefetch" href="/blog/assets/js/25.31cd7e03.js"><link rel="prefetch" href="/blog/assets/js/26.33e13135.js"><link rel="prefetch" href="/blog/assets/js/27.23cfcf44.js"><link rel="prefetch" href="/blog/assets/js/28.67f3e5f1.js"><link rel="prefetch" href="/blog/assets/js/29.25710728.js"><link rel="prefetch" href="/blog/assets/js/30.b6c183c8.js"><link rel="prefetch" href="/blog/assets/js/31.92ae948f.js"><link rel="prefetch" href="/blog/assets/js/32.0644f365.js"><link rel="prefetch" href="/blog/assets/js/34.4dc117ac.js"><link rel="prefetch" href="/blog/assets/js/35.e24a02ac.js"><link rel="prefetch" href="/blog/assets/js/36.74def00a.js"><link rel="prefetch" href="/blog/assets/js/37.3f39d15e.js"><link rel="prefetch" href="/blog/assets/js/38.78379f7b.js"><link rel="prefetch" href="/blog/assets/js/39.e12c28f2.js"><link rel="prefetch" href="/blog/assets/js/40.eced14bc.js"><link rel="prefetch" href="/blog/assets/js/41.f104551f.js"><link rel="prefetch" href="/blog/assets/js/42.21ec0d93.js"><link rel="prefetch" href="/blog/assets/js/43.984dadf1.js"><link rel="prefetch" href="/blog/assets/js/44.a870dc42.js"><link rel="prefetch" href="/blog/assets/js/45.7b845df4.js"><link rel="prefetch" href="/blog/assets/js/46.31a736c8.js"><link rel="prefetch" href="/blog/assets/js/5.2b577ff2.js"><link rel="prefetch" href="/blog/assets/js/6.5cf5829a.js"><link rel="prefetch" href="/blog/assets/js/7.46c43574.js"><link rel="prefetch" href="/blog/assets/js/8.97b71141.js"><link rel="prefetch" href="/blog/assets/js/9.5a3cc726.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.8f04fa7f.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.4a9580f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Lorain's ä¸ªäººä¸»é¡µğŸ–Œ</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  ğŸ“œå‰ç«¯æŠ€æœ¯
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  ğŸ“Šè®¡ç®—æœºåŸºç¡€
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  ğŸ€å…¶ä»–è®°å½•
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  â­ï¸Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  ğŸ“œå‰ç«¯æŠ€æœ¯
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  ğŸ“Šè®¡ç®—æœºåŸºç¡€
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  ğŸ€å…¶ä»–è®°å½•
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  â­ï¸Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JSè¯­è¨€åŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5åŠæ¡†æ¶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/Babelæ‚è°ˆ.html" class="sidebar-link">Babel æ‚è°ˆ</a></li><li><a href="/blog/skills/ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°.html" class="sidebar-link">ç®€æ˜“æ‰“åŒ…å·¥å…·å®ç°</a></li><li><a href="/blog/skills/WebpackåŸºç¡€çŸ¥è¯†.html" class="sidebar-link">Webpack åŸºç¡€çŸ¥è¯†</a></li><li><a href="/blog/skills/Webpackæ¨¡å—å®ç°.html" class="sidebar-link">Webpack æ¨¡å—å®ç°</a></li><li><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html" class="active sidebar-link">Webpack å¼‚æ­¥åŠ è½½</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html#æ¨¡å—è§„èŒƒ" class="sidebar-link">æ¨¡å—è§„èŒƒ</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html#æ¨¡å—æ‰“åŒ…" class="sidebar-link">æ¨¡å—æ‰“åŒ…</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html#es6-è¯­æ³•æ”¯æŒ" class="sidebar-link">ES6 è¯­æ³•æ”¯æŒ</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html#æ¨¡å—å¼‚æ­¥åŠ è½½" class="sidebar-link">æ¨¡å—å¼‚æ­¥åŠ è½½</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html#æ€»ç»“" class="sidebar-link">æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="/blog/skills/Webpackå¼‚æ­¥åŠ è½½.html#å‚è€ƒæ–‡ç« " class="sidebar-link">å‚è€ƒæ–‡ç« </a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®‰å…¨åŠæ€§èƒ½ä¼˜åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æœåŠ¡ç«¯å…¥é—¨</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-å¼‚æ­¥åŠ è½½"><a href="#webpack-å¼‚æ­¥åŠ è½½" class="header-anchor">#</a> Webpack å¼‚æ­¥åŠ è½½</h1> <blockquote><p>æ–‡ç« <a href="https://juejin.im/post/5c94a2f36fb9a070fc623df4" target="_blank" rel="noopener noreferrer">è½¬è‡ªç½‘ç»œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>åœ¨ä½¿ç”¨ webpack çš„è¿‡ç¨‹ä¸­ï¼Œä½ æ˜¯å¦å¥½å¥‡ webpack æ‰“åŒ…çš„ä»£ç ä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è·‘ï¼Ÿä¸ºä»€ä¹ˆ webpack å¯ä»¥æ”¯æŒå„ç§ ES6 æœ€æ–°è¯­æ³•ï¼Ÿä¸ºä»€ä¹ˆåœ¨ webpack ä¸­å¯ä»¥ä¹¦å†™ import ES6 æ¨¡å—ï¼Œä¹Ÿæ”¯æŒ require CommonJS æ¨¡å—ï¼Ÿ</p> <h2 id="æ¨¡å—è§„èŒƒ"><a href="#æ¨¡å—è§„èŒƒ" class="header-anchor">#</a> æ¨¡å—è§„èŒƒ</h2> <p>å…³äºæ¨¡å—ï¼Œæˆ‘ä»¬å…ˆæ¥è®¤è¯†ä¸‹ç›®å‰ä¸»æµçš„æ¨¡å—è§„èŒƒï¼ˆè‡ªä»æœ‰äº† ES6 Module åŠ Webpack ç­‰å·¥å…·ï¼ŒAMD/CMD è§„èŒƒç”Ÿå­˜ç©ºé—´å·²ç»å¾ˆå°äº†ï¼‰ï¼š</p> <ul><li>CommonJS</li> <li>UMD</li> <li>ES6 Module</li></ul> <h3 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJS</h3> <p>ES6 å‰ï¼Œjs æ²¡æœ‰å±äºè‡ªå·±çš„æ¨¡å—è§„èŒƒï¼Œæ‰€ä»¥ç¤¾åŒºåˆ¶å®šäº† CommonJS è§„èŒƒã€‚è€Œ NodeJS æ‰€ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿå°±æ˜¯åŸºäº CommonJS è§„èŒƒå®ç°çš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// CommonJS å¯¼å‡º</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// CommonJS å¯¼å…¥</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./foo.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><h3 id="umd"><a href="#umd" class="header-anchor">#</a> UMD</h3> <p>æ ¹æ®å½“å‰è¿è¡Œç¯å¢ƒçš„åˆ¤æ–­ï¼Œå¦‚æœæ˜¯ Node ç¯å¢ƒ å°±æ˜¯ä½¿ç”¨ CommonJS è§„èŒƒï¼Œ å¦‚æœä¸æ˜¯å°±åˆ¤æ–­æ˜¯å¦ä¸º AMD ç¯å¢ƒï¼Œ æœ€åå¯¼å‡ºå…¨å±€å˜é‡ã€‚è¿™æ ·ä»£ç å¯ä»¥åŒæ—¶è¿è¡Œåœ¨ Node å’Œæµè§ˆå™¨ç¯å¢ƒä¸­ã€‚ç›®å‰å¤§éƒ¨åˆ†åº“éƒ½æ˜¯æ‰“åŒ…æˆ UMD è§„èŒƒï¼ŒWebpack ä¹Ÿæ”¯æŒ UMD æ‰“åŒ…ï¼Œé…ç½® API æ˜¯<a href="https://webpack.docschina.org/configuration/output/#output-librarytarget" target="_blank" rel="noopener noreferrer">output.libraryTarget<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚è¯¦ç»†æ¡ˆä¾‹å¯ä»¥çœ‹ç¬”è€…å°è£…çš„ npm å·¥å…·åŒ…ï¼š<a href="https://github.com/lq782655835/cache-manage-js" target="_blank" rel="noopener noreferrer">cache-manage-js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">global<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module <span class="token operator">!==</span> <span class="token string">'undefined'</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd
    <span class="token operator">?</span> <span class="token function">define</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>global<span class="token punctuation">.</span>libName <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><h3 id="es6-module"><a href="#es6-module" class="header-anchor">#</a> ES6 Module</h3> <p>ES6 æ¨¡å—çš„è®¾è®¡æ€æƒ³æ˜¯å°½é‡çš„é™æ€åŒ–ï¼Œä½¿å¾—ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºçš„å˜é‡ã€‚å…·ä½“æ€æƒ³å’Œè¯­æ³•å¯ä»¥çœ‹ç¬”è€…çš„å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://juejin.im/post/(https://lq782655835.github.io/blogs/es6/es6-4.module.html)" target="_blank" rel="noopener noreferrer">ES6-æ¨¡å—è¯¦è§£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// es6æ¨¡å— å¯¼å‡º</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token function-variable function">foo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// es6æ¨¡å— å¯¼å…¥</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">'./foo'</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><h2 id="æ¨¡å—æ‰“åŒ…"><a href="#æ¨¡å—æ‰“åŒ…" class="header-anchor">#</a> æ¨¡å—æ‰“åŒ…</h2> <p>æ—¢ç„¶æ¨¡å—è§„èŒƒæœ‰è¿™ä¹ˆå¤šï¼Œé‚£ webpack æ˜¯å¦‚ä½•å»è§£æä¸åŒçš„æ¨¡å—å‘¢ï¼Ÿ</p> <p>webpack æ ¹æ® webpack.config.js ä¸­çš„å…¥å£æ–‡ä»¶ï¼Œåœ¨å…¥å£æ–‡ä»¶é‡Œè¯†åˆ«æ¨¡å—ä¾èµ–ï¼Œä¸ç®¡è¿™é‡Œçš„æ¨¡å—ä¾èµ–æ˜¯ç”¨ CommonJS å†™çš„ï¼Œè¿˜æ˜¯ ES6 Module è§„èŒƒå†™çš„ï¼Œwebpack ä¼šè‡ªåŠ¨è¿›è¡Œåˆ†æï¼Œå¹¶é€šè¿‡è½¬æ¢ã€ç¼–è¯‘ä»£ç ï¼Œæ‰“åŒ…æˆæœ€ç»ˆçš„æ–‡ä»¶ã€‚<code>æœ€ç»ˆæ–‡ä»¶ä¸­çš„æ¨¡å—å®ç°æ˜¯åŸºäºwebpackè‡ªå·±å®ç°çš„webpack_requireï¼ˆes5ä»£ç ï¼‰</code>ï¼Œæ‰€ä»¥æ‰“åŒ…åçš„æ–‡ä»¶å¯ä»¥è·‘åœ¨æµè§ˆå™¨ä¸Šã€‚</p> <p>åŒæ—¶ä»¥ä¸Šæ„å‘³ç€åœ¨ webapck ç¯å¢ƒä¸‹ï¼Œä½ å¯ä»¥åªä½¿ç”¨ ES6 æ¨¡å—è¯­æ³•ä¹¦å†™ä»£ç ï¼ˆé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯è¿™ä¹ˆåšçš„ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ CommonJS æ¨¡å—è¯­æ³•ï¼Œç”šè‡³å¯ä»¥ä¸¤è€…æ··åˆä½¿ç”¨ã€‚å› ä¸ºä» webpack2 å¼€å§‹ï¼Œå†…ç½®äº†å¯¹ ES6ã€CommonJSã€AMD æ¨¡å—åŒ–è¯­å¥çš„æ”¯æŒï¼Œ<code>webpackä¼šå¯¹å„ç§æ¨¡å—è¿›è¡Œè¯­æ³•åˆ†æï¼Œå¹¶åšè½¬æ¢ç¼–è¯‘</code>ã€‚</p> <p>æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥åˆ†æä¸‹æ‰“åŒ…åçš„æºç æ–‡ä»¶ï¼Œä¾‹å­æºä»£ç åœ¨ <a href="https://github.com/lq782655835/webpack-module-example" target="_blank" rel="noopener noreferrer">webpack-module-example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  <span class="token comment">// JavaScript æ‰§è¡Œå…¥å£æ–‡ä»¶</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŠŠæ‰€æœ‰ä¾èµ–çš„æ¨¡å—åˆå¹¶è¾“å‡ºåˆ°ä¸€ä¸ª bundle.js æ–‡ä»¶</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    <span class="token comment">// è¾“å‡ºæ–‡ä»¶éƒ½æ”¾åˆ° dist ç›®å½•ä¸‹</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/add</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'hello world,'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œç‰¹æ„ä½¿ç”¨äº†ES6è¯­æ³•</span>
  <span class="token keyword">return</span> name <span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// src/main.js</span>
<span class="token keyword">import</span> Add <span class="token keyword">from</span> <span class="token string">'./add'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Add<span class="token punctuation">,</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><p>æ‰“åŒ…åç²¾ç®€çš„ bundle.js æ–‡ä»¶å¦‚ä¸‹:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// modulesæ˜¯å­˜æ”¾æ‰€æœ‰æ¨¡å—çš„æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å­˜å‚¨{ æ¨¡å—è·¯å¾„: æ¨¡å—å¯¼å‡ºä»£ç å‡½æ•° }</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ¨¡å—ç¼“å­˜ä½œç”¨ï¼Œå·²åŠ è½½çš„æ¨¡å—å¯ä»¥ä¸ç”¨å†é‡æ–°è¯»å–ï¼Œæå‡æ€§èƒ½</span>
  <span class="token keyword">var</span> installedModules <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// å…³é”®å‡½æ•°ï¼ŒåŠ è½½æ¨¡å—ä»£ç </span>
  <span class="token comment">// å½¢å¼æœ‰ç‚¹åƒNodeçš„CommonJSæ¨¡å—ï¼Œä½†è¿™é‡Œæ˜¯å¯è·‘åœ¨æµè§ˆå™¨ä¸Šçš„es5ä»£ç </span>
  <span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç¼“å­˜æ£€æŸ¥ï¼Œæœ‰åˆ™ç›´æ¥ä»ç¼“å­˜ä¸­å–å¾—</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å…ˆåˆ›å»ºä¸€ä¸ªç©ºæ¨¡å—ï¼Œå¡å…¥ç¼“å­˜ä¸­</span>
    <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">(</span>installedModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      i<span class="token operator">:</span> moduleId<span class="token punctuation">,</span>
      l<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æ ‡è®°æ˜¯å¦å·²ç»åŠ è½½</span>
      exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// åˆå§‹æ¨¡å—ä¸ºç©º</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æŠŠè¦åŠ è½½çš„æ¨¡å—å†…å®¹ï¼ŒæŒ‚è½½åˆ°module.exportsä¸Š</span>
    modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
      module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span>
      module<span class="token punctuation">,</span>
      module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span>
      __webpack_require__
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    module<span class="token punctuation">.</span>l <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// æ ‡è®°ä¸ºå·²åŠ è½½</span>

    <span class="token comment">// è¿”å›åŠ è½½çš„æ¨¡å—ï¼Œè°ƒç”¨æ–¹ç›´æ¥è°ƒç”¨å³å¯</span>
    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// __webpack_require__å¯¹è±¡ä¸‹çš„rå‡½æ•°</span>
  <span class="token comment">// åœ¨module.exportsä¸Šå®šä¹‰__esModuleä¸ºtrueï¼Œè¡¨æ˜æ˜¯ä¸€ä¸ªæ¨¡å—å¯¹è±¡</span>
  __webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">r</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// å¯åŠ¨å…¥å£æ¨¡å—main.js</span>
  <span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token string">'./src/main.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// addæ¨¡å—</span>
  <span class="token string">'./src/add.js'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åœ¨module.exportsä¸Šå®šä¹‰__esModuleä¸ºtrue</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç›´æ¥æŠŠaddæ¨¡å—å†…å®¹ï¼Œèµ‹ç»™module.exports.defaultå¯¹è±¡ä¸Š</span>
    __webpack_exports__<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'hello world,'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> name <span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// å…¥å£æ¨¡å—</span>
  <span class="token string">'./src/main.js'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ‹¿åˆ°addæ¨¡å—çš„å®šä¹‰</span>
    <span class="token comment">// _add__WEBPACK_IMPORTED_MODULE_0__ = module.exportsï¼Œæœ‰ç‚¹ç±»ä¼¼require</span>
    <span class="token keyword">var</span> _add__WEBPACK_IMPORTED_MODULE_0__ <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">'./src/add.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// addæ¨¡å—å†…å®¹: _add__WEBPACK_IMPORTED_MODULE_0__[&quot;default&quot;]</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      _add__WEBPACK_IMPORTED_MODULE_0__<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function">Object</span><span class="token punctuation">(</span>_add__WEBPACK_IMPORTED_MODULE_0__<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><p>ä»¥ä¸Šæ ¸å¿ƒä»£ç ä¸­ï¼Œèƒ½è®©æ‰“åŒ…åçš„ä»£ç ç›´æ¥è·‘åœ¨æµè§ˆå™¨ä¸­ï¼Œæ˜¯å› ä¸º webpack é€šè¿‡__webpack_require<strong>å‡½æ•°æ¨¡æ‹Ÿäº†æ¨¡å—çš„åŠ è½½ï¼ˆç±»ä¼¼äº node ä¸­çš„ require è¯­æ³•ï¼‰ï¼ŒæŠŠå®šä¹‰çš„æ¨¡å—å†…å®¹æŒ‚è½½åˆ° module.exports ä¸Šã€‚åŒæ—¶__webpack_require</strong>å‡½æ•°ä¸­ä¹Ÿå¯¹æ¨¡å—ç¼“å­˜åšäº†ä¼˜åŒ–ï¼Œé˜²æ­¢æ¨¡å—äºŒæ¬¡é‡æ–°åŠ è½½ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚</p> <p>å†è®©æˆ‘ä»¬çœ‹ä¸‹ webpack çš„æºç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack/lib/MainTemplate.js</span>

<span class="token comment">// ä¸»æ–‡ä»¶æ¨¡æ¿</span>
<span class="token comment">// webpackç”Ÿæˆçš„æœ€ç»ˆæ–‡ä»¶å«chunkï¼ŒchunkåŒ…å«è‹¥å¹²çš„é€»è¾‘æ¨¡å—ï¼Œå³ä¸ºmodule</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>render<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span> <span class="token string">&quot;MainTemplate&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token parameter">bootstrapSource<span class="token punctuation">,</span> chunk<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> moduleTemplate<span class="token punctuation">,</span> dependencyTemplates</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcatSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;/******/ (function(modules) { // webpackBootstrap\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å…¥å£å†…å®¹ï¼Œ__webpack_require__å°±åœ¨bootstrapSourceä¸­</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrefixSource</span><span class="token punctuation">(</span><span class="token string">&quot;/******/&quot;</span><span class="token punctuation">,</span> bootstrapSource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;/******/ })\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token string">&quot;/************************************************************************/\n&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;/******/ (&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token comment">// ä¾èµ–çš„moduleéƒ½ä¼šå†™å…¥å¯¹åº”æ•°ç»„</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">modules</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">RawSource</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      chunk<span class="token punctuation">,</span>
      hash<span class="token punctuation">,</span>
      moduleTemplate<span class="token punctuation">,</span>
      dependencyTemplates
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  source<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> source<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
å¤åˆ¶ä»£ç 
</code></pre></div><h2 id="es6-è¯­æ³•æ”¯æŒ"><a href="#es6-è¯­æ³•æ”¯æŒ" class="header-anchor">#</a> ES6 è¯­æ³•æ”¯æŒ</h2> <p>å¯èƒ½ç»†å¿ƒçš„è¯»è€…çœ‹åˆ°ï¼Œä»¥ä¸Šæ‰“åŒ…åçš„ add æ¨¡å—ä»£ç ä¸­ä¾ç„¶è¿˜æ˜¯ ES6 è¯­æ³•ï¼Œåœ¨ä½ç«¯çš„æµè§ˆå™¨ä¸­ä¸æ”¯æŒã€‚è¿™æ˜¯å› ä¸ºæ²¡æœ‰å¯¹åº”çš„ loader å»è§£æ js ä»£ç ï¼Œwebpack æŠŠæ‰€æœ‰çš„èµ„æºéƒ½è§†ä½œæ¨¡å—ï¼Œä¸åŒçš„èµ„æºä½¿ç”¨ä¸åŒçš„ loader è¿›è¡Œè½¬æ¢ã€‚</p> <p>è¿™é‡Œéœ€è¦ä½¿ç”¨ babel-loader åŠå…¶æ’ä»¶@babel/preset-env è¿›è¡Œå¤„ç†ï¼ŒæŠŠ ES6 ä»£ç è½¬æ¢æˆå¯åœ¨æµè§ˆå™¨ä¸­è·‘çš„ es5 ä»£ç ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// å¯¹ä»¥jsåç¼€çš„æ–‡ä»¶èµ„æºï¼Œç”¨babelè¿›è¡Œå¤„ç†</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.m?js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(node_modules|bower_components)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç 
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç»è¿‡babelå¤„ç†es6è¯­æ³•åçš„ä»£ç </span>
__webpack_exports__<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _name <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'hello world,'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name <span class="token operator">=</span> _name<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token keyword">return</span> name <span class="token operator">+</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><h2 id="æ¨¡å—å¼‚æ­¥åŠ è½½"><a href="#æ¨¡å—å¼‚æ­¥åŠ è½½" class="header-anchor">#</a> æ¨¡å—å¼‚æ­¥åŠ è½½</h2> <p>ä»¥ä¸Š webpack æŠŠæ‰€æœ‰æ¨¡å—æ‰“åŒ…åˆ°ä¸»æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æ¨¡å—åŠ è½½æ–¹å¼éƒ½æ˜¯åŒæ­¥æ–¹å¼ã€‚ä½†åœ¨å¼€å‘åº”ç”¨è¿‡ç¨‹ä¸­ï¼ŒæŒ‰éœ€åŠ è½½ï¼ˆä¹Ÿå«æ‡’åŠ è½½ï¼‰ä¹Ÿæ˜¯ç»å¸¸ä½¿ç”¨çš„ä¼˜åŒ–æŠ€å·§ä¹‹ä¸€ã€‚æŒ‰éœ€åŠ è½½ï¼Œé€šä¿—è®²å°±æ˜¯ä»£ç æ‰§è¡Œåˆ°å¼‚æ­¥æ¨¡å—ï¼ˆæ¨¡å—å†…å®¹åœ¨å¦å¤–ä¸€ä¸ª js æ–‡ä»¶ä¸­ï¼‰ï¼Œé€šè¿‡ç½‘ç»œè¯·æ±‚å³æ—¶åŠ è½½å¯¹åº”çš„å¼‚æ­¥æ¨¡å—ä»£ç ï¼Œå†ç»§ç»­æ¥ä¸‹å»çš„æµç¨‹ã€‚é‚£ webpack æ˜¯å¦‚ä½•æ‰§è¡Œä»£ç æ—¶ï¼Œåˆ¤æ–­å“ªäº›ä»£ç æ˜¯å¼‚æ­¥æ¨¡å—å‘¢ï¼Ÿwebpack åˆæ˜¯å¦‚ä½•åŠ è½½å¼‚æ­¥æ¨¡å—å‘¢ï¼Ÿ</p> <p>webpack æœ‰ä¸ª<a href="https://webpack.js.org/api/module-methods/#requireensure" target="_blank" rel="noopener noreferrer">require.ensure<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> api è¯­æ³•æ¥æ ‡è®°ä¸ºå¼‚æ­¥åŠ è½½æ¨¡å—ï¼Œæœ€æ–°çš„ webpack4 æ¨èä½¿ç”¨æ–°çš„<a href="https://webpack.js.org/api/module-methods/#import-1" target="_blank" rel="noopener noreferrer">import()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> api(éœ€è¦é…åˆ@babel/plugin-syntax-dynamic-import æ’ä»¶)ã€‚å› ä¸º require.ensure æ˜¯é€šè¿‡å›è°ƒå‡½æ•°æ‰§è¡Œæ¥ä¸‹æ¥çš„æµç¨‹ï¼Œè€Œ import()è¿”å› promiseï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨æœ€æ–°çš„ ES8 async/await è¯­æ³•ï¼Œä½¿å¾—å¯ä»¥åƒä¹¦å†™åŒæ­¥ä»£ç ä¸€æ ·ï¼Œæ‰§è¡Œå¼‚æ­¥æµç¨‹ã€‚</p> <p>ç°åœ¨æˆ‘ä»¬ä» webpack æ‰“åŒ…åçš„æºç æ¥çœ‹ä¸‹ï¼Œwebpack æ˜¯å¦‚ä½•å®ç°å¼‚æ­¥æ¨¡å—åŠ è½½çš„ã€‚ä¿®æ”¹å…¥å£æ–‡ä»¶ main.jsï¼Œå¼•å…¥å¼‚æ­¥æ¨¡å— async.jsï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> Add <span class="token keyword">from</span> <span class="token string">'./add'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Add<span class="token punctuation">,</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æŒ‰éœ€åŠ è½½</span>
<span class="token comment">// æ–¹å¼1: require.ensure</span>
<span class="token comment">// require.ensure([], function(require){</span>
<span class="token comment">//     var asyncModule = require('./async')</span>
<span class="token comment">//     console.log(asyncModule.default, 234)</span>
<span class="token comment">// })</span>

<span class="token comment">// æ–¹å¼2: webpack4æ–°çš„importè¯­æ³•</span>
<span class="token comment">// éœ€è¦åŠ @babel/plugin-syntax-dynamic-importæ’ä»¶</span>
<span class="token keyword">let</span> <span class="token function-variable function">asyncModuleWarp</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">asyncModuleWarp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">,</span> <span class="token number">234</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// async.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'hello, aysnc module'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><p>ä»¥ä¸Šä»£ç æ‰“åŒ…ä¼šç”Ÿæˆä¸¤ä¸ª chunk æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ä¸»æ–‡ä»¶<code>main.bundle.js</code>ä»¥åŠå¼‚æ­¥æ¨¡å—æ–‡ä»¶<code>0.bundle.js</code>ã€‚åŒæ ·ï¼Œä¸ºæ–¹ä¾¿è¯»è€…å¿«é€Ÿç†è§£ï¼Œç²¾ç®€ä¿ç•™ä¸»æµç¨‹ä»£ç ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 0.bundle.js</span>

<span class="token comment">// å¼‚æ­¥æ¨¡å—</span>
<span class="token comment">// window[&quot;webpackJsonp&quot;]æ˜¯è¿æ¥å¤šä¸ªchunkæ–‡ä»¶çš„æ¡¥æ¢</span>
<span class="token comment">// window[&quot;webpackJsonp&quot;].push = ä¸»chunkæ–‡ä»¶.webpackJsonpCallback</span>
<span class="token punctuation">(</span>window<span class="token punctuation">[</span><span class="token string">'webpackJsonp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> window<span class="token punctuation">[</span><span class="token string">'webpackJsonp'</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// å¼‚æ­¥æ¨¡å—æ ‡è¯†chunkId,å¯åˆ¤æ–­å¼‚æ­¥ä»£ç æ˜¯å¦åŠ è½½æˆåŠŸ</span>
  <span class="token comment">// è·ŸåŒæ­¥æ¨¡å—ä¸€æ ·ï¼Œå­˜æ”¾äº†{æ¨¡å—è·¯å¾„ï¼šæ¨¡å—å†…å®¹}</span>
  <span class="token punctuation">{</span>
    <span class="token string">'./src/async.js'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>
      <span class="token parameter">module<span class="token punctuation">,</span>
      __webpack_exports__<span class="token punctuation">,</span>
      __webpack_require__</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      __webpack_exports__<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'hello, aysnc module'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç <span class="token punctuation">;</span>
</code></pre></div><p>ä»¥ä¸ŠçŸ¥é“ï¼Œå¼‚æ­¥æ¨¡å—æ‰“åŒ…åçš„æ–‡ä»¶ä¸­<strong>ä¿å­˜ç€å¼‚æ­¥æ¨¡å—æºä»£ç </strong>ï¼ŒåŒæ—¶ä¸ºäº†åŒºåˆ†ä¸åŒçš„å¼‚æ­¥æ¨¡å—ï¼Œ<strong>è¿˜ä¿å­˜ç€è¯¥å¼‚æ­¥æ¨¡å—å¯¹åº”çš„æ ‡è¯†ï¼šchunkId</strong>ã€‚ä»¥ä¸Šä»£ç ä¸»åŠ¨è°ƒç”¨ window[&quot;webpackJsonp&quot;].push å‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯è¿æ¥å¼‚æ­¥æ¨¡å—ä¸ä¸»æ¨¡å—çš„å…³é”®å‡½æ•°ï¼Œè¯¥å‡½æ•°å®šä¹‰åœ¨ä¸»æ–‡ä»¶ä¸­ï¼Œå®é™…ä¸Š<code>window[&quot;webpackJsonp&quot;].push = webpackJsonpCallback</code>ï¼Œè¯¦ç»†æºç å’±ä»¬çœ‹çœ‹ä¸»æ–‡ä»¶æ‰“åŒ…åçš„ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.bundle.js</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// è·å–åˆ°å¼‚æ­¥chunkä»£ç åçš„å›è°ƒå‡½æ•°</span>
<span class="token comment">// è¿æ¥ä¸¤ä¸ªæ¨¡å—æ–‡ä»¶çš„å…³é”®å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">webpackJsonpCallback</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> chunkIds <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//data[0]å­˜æ”¾äº†å¼‚æ­¥æ¨¡å—å¯¹åº”çš„chunkId</span>
  <span class="token keyword">var</span> moreModules <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// data[1]å­˜æ”¾äº†å¼‚æ­¥æ¨¡å—ä»£ç </span>

  <span class="token comment">// æ ‡è®°å¼‚æ­¥æ¨¡å—å·²åŠ è½½æˆåŠŸ</span>
  <span class="token keyword">var</span> moduleId<span class="token punctuation">,</span> chunkId<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> resolves <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> chunkIds<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    chunkId <span class="token operator">=</span> chunkIds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      resolves<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æŠŠå¼‚æ­¥æ¨¡å—ä»£ç éƒ½å­˜æ”¾åˆ°modulesä¸­</span>
  <span class="token comment">// æ­¤æ—¶ä¸‡äº‹ä¿±å¤‡ï¼Œå¼‚æ­¥ä»£ç éƒ½å·²ç»åŒæ­¥åŠ è½½åˆ°ä¸»æ¨¡å—ä¸­</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span>moduleId <span class="token keyword">in</span> moreModules<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> moreModules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡ç‚¹ï¼šæ‰§è¡Œresolve() = installedChunks[chunkId][0]()è¿”å›promise</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>resolves<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    resolves<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// è®°å½•å“ªäº›chunkå·²åŠ è½½å®Œæˆ</span>
<span class="token keyword">var</span> installedChunks <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;main&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// __webpack_require__ä¾ç„¶æ˜¯åŒæ­¥è¯»å–æ¨¡å—ä»£ç ä½œç”¨</span>
<span class="token keyword">function</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token comment">// åŠ è½½å¼‚æ­¥æ¨¡å—</span>
__webpack_require__<span class="token punctuation">.</span><span class="token function-variable function">e</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">requireEnsure</span><span class="token punctuation">(</span><span class="token parameter">chunkId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åˆ›å»ºpromise</span>
  <span class="token comment">// æŠŠresolveä¿å­˜åˆ°installedChunks[chunkId]ä¸­ï¼Œç­‰å¾…ä»£ç åŠ è½½å¥½å†æ‰§è¡Œresolve()ä»¥è¿”å›promise</span>
  <span class="token keyword">var</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// é€šè¿‡å¾€headå¤´éƒ¨æ’å…¥scriptæ ‡ç­¾å¼‚æ­¥åŠ è½½åˆ°chunkä»£ç </span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>charset <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span>
  <span class="token comment">// __webpack_require__.pä¸ºpublicePath</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> __webpack_require__<span class="token punctuation">.</span>p <span class="token operator">+</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token operator">||</span>chunkId<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.bundle.js&quot;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">onScriptComplete</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> chunk <span class="token operator">=</span> installedChunks<span class="token punctuation">[</span>chunkId<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>onerror <span class="token operator">=</span> script<span class="token punctuation">.</span>onload <span class="token operator">=</span> onScriptComplete<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> jsonpArray <span class="token operator">=</span> window<span class="token punctuation">[</span><span class="token string">&quot;webpackJsonp&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> window<span class="token punctuation">[</span><span class="token string">&quot;webpackJsonp&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// å…³é”®ä»£ç ï¼š window[&quot;webpackJsonp&quot;].push = webpackJsonpCallback</span>
jsonpArray<span class="token punctuation">.</span>push <span class="token operator">=</span> webpackJsonpCallback<span class="token punctuation">;</span>

<span class="token comment">// å…¥å£æ‰§è¡Œ</span>
<span class="token keyword">return</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token string">&quot;./src/main.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token string">&quot;./src/add.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token string">&quot;./src/main.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åŒæ­¥æ–¹å¼</span>
  <span class="token keyword">var</span> Add <span class="token operator">=</span> <span class="token function">__webpack_require__</span><span class="token punctuation">(</span><span class="token string">&quot;./src/add.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Add<span class="token punctuation">,</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// å¼‚æ­¥æ–¹å¼</span>
  <span class="token keyword">var</span> <span class="token function-variable function">asyncModuleWarp</span> <span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _ref <span class="token operator">=</span> <span class="token function">_asyncToGenerator</span><span class="token punctuation">(</span> regeneratorRuntime<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">_callee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> regeneratorRuntime<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">_callee$</span><span class="token punctuation">(</span><span class="token parameter">_context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œåˆ°å¼‚æ­¥ä»£ç æ—¶ï¼Œä¼šå»æ‰§è¡Œ__webpack_require__.eæ–¹æ³•</span>
        <span class="token comment">// __webpack_require__.eå…¶è¿”å›promiseï¼Œè¡¨ç¤ºå¼‚æ­¥ä»£ç éƒ½å·²ç»åŠ è½½åˆ°ä¸»æ¨¡å—äº†</span>
        <span class="token comment">// æ¥ä¸‹æ¥åƒåŒæ­¥ä¸€æ ·ï¼Œç›´æ¥åŠ è½½æ¨¡å—</span>
        <span class="token keyword">return</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;./src/async.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> _callee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">asyncModuleWarp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">_ref</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">asyncModuleWarp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">,</span> <span class="token number">234</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
å¤åˆ¶ä»£ç 
</code></pre></div><p>ä»ä¸Šé¢æºç å¯ä»¥çŸ¥é“ï¼Œ<strong>webpack å®ç°æ¨¡å—çš„å¼‚æ­¥åŠ è½½æœ‰ç‚¹åƒ jsonp çš„æµç¨‹</strong>ã€‚åœ¨ä¸» js æ–‡ä»¶ä¸­é€šè¿‡åœ¨ head ä¸­æ„å»º script æ ‡ç­¾æ–¹å¼ï¼Œå¼‚æ­¥åŠ è½½æ¨¡å—ä¿¡æ¯ï¼›å†ä½¿ç”¨å›è°ƒå‡½æ•° webpackJsonpCallbackï¼ŒæŠŠå¼‚æ­¥çš„æ¨¡å—æºç åŒæ­¥åˆ°ä¸»æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥åç»­æ“ä½œå¼‚æ­¥æ¨¡å—å¯ä»¥åƒåŒæ­¥æ¨¡å—ä¸€æ ·ã€‚ æºç å…·ä½“å®ç°æµç¨‹ï¼š</p> <ol><li>é‡åˆ°å¼‚æ­¥æ¨¡å—æ—¶ï¼Œä½¿ç”¨<code>__webpack_require__.e</code>å‡½æ•°å»æŠŠå¼‚æ­¥ä»£ç åŠ è½½è¿›æ¥ã€‚è¯¥å‡½æ•°ä¼šåœ¨ html çš„ head ä¸­åŠ¨æ€å¢åŠ  script æ ‡ç­¾ï¼Œsrc æŒ‡å‘æŒ‡å®šçš„å¼‚æ­¥æ¨¡å—å­˜æ”¾çš„æ–‡ä»¶ã€‚</li> <li>åŠ è½½çš„å¼‚æ­¥æ¨¡å—æ–‡ä»¶ä¼šæ‰§è¡Œ<code>webpackJsonpCallback</code>å‡½æ•°ï¼ŒæŠŠå¼‚æ­¥æ¨¡å—åŠ è½½åˆ°ä¸»æ–‡ä»¶ä¸­ã€‚</li> <li>æ‰€ä»¥åç»­å¯ä»¥åƒåŒæ­¥æ¨¡å—ä¸€æ ·,ç›´æ¥ä½¿ç”¨<code>__webpack_require__(&quot;./src/async.js&quot;)</code>åŠ è½½å¼‚æ­¥æ¨¡å—ã€‚</li></ol> <blockquote><p>æ³¨æ„æºç ä¸­çš„ primose ä½¿ç”¨éå¸¸ç²¾å¦™ï¼Œä¸»æ¨¡å—åŠ è½½å®Œæˆå¼‚æ­¥æ¨¡å—æ‰ resolve()</p></blockquote> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> æ€»ç»“</h2> <ol><li>webpack å¯¹äº ES æ¨¡å—/CommonJS æ¨¡å—çš„å®ç°ï¼Œæ˜¯åŸºäºè‡ªå·±å®ç°çš„ webpack_requireï¼Œæ‰€ä»¥ä»£ç èƒ½è·‘åœ¨æµè§ˆå™¨ä¸­ã€‚</li> <li>ä» webpack2 å¼€å§‹ï¼Œå·²ç»å†…ç½®äº†å¯¹ ES6ã€CommonJSã€AMD æ¨¡å—åŒ–è¯­å¥çš„æ”¯æŒã€‚ä½†ä¸åŒ…æ‹¬æ–°çš„ ES6 è¯­æ³•è½¬ä¸º ES5 ä»£ç ï¼Œè¿™éƒ¨åˆ†å·¥ä½œè¿˜æ˜¯ç•™ç»™äº† babel åŠå…¶æ’ä»¶ã€‚</li> <li>åœ¨ webpack ä¸­å¯ä»¥åŒæ—¶ä½¿ç”¨ ES6 æ¨¡å—å’Œ CommonJS æ¨¡å—ã€‚å› ä¸º module.exports å¾ˆåƒ export defaultï¼Œæ‰€ä»¥ ES6 æ¨¡å—å¯ä»¥å¾ˆæ–¹ä¾¿å…¼å®¹ CommonJSï¼šimport XXX from 'commonjs-module'ã€‚åè¿‡æ¥ CommonJS å…¼å®¹ ES6 æ¨¡å—ï¼Œéœ€è¦é¢å¤–åŠ ä¸Š defaultï¼šrequire('es-module').defaultã€‚</li> <li>webpack å¼‚æ­¥åŠ è½½æ¨¡å—å®ç°æµç¨‹è·Ÿ jsonp åŸºæœ¬ä¸€è‡´ã€‚</li></ol> <h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="header-anchor">#</a> å‚è€ƒæ–‡ç« </h2> <ul><li><a href="https://juejin.im/post/5aaa37c8f265da23945f365c" target="_blank" rel="noopener noreferrer">å‰ç«¯æ¨¡å—åŒ–ï¼šCommonJS,AMD,CMD,ES6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://segmentfault.com/a/1190000017878394" target="_blank" rel="noopener noreferrer">æ·±å…¥ CommonJs ä¸ ES6 Module<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/Pines-Cheng/blog/issues/45" target="_blank" rel="noopener noreferrer">Webpack å°†ä»£ç æ‰“åŒ…æˆä»€ä¹ˆæ ·å­<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/29551683" target="_blank" rel="noopener noreferrer">Webpack æºç åˆ†æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://webpack.js.org/guides/code-splitting" target="_blank" rel="noopener noreferrer">Webpack Code Splitting<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æ›´æ–°æ—¶é—´:</span> <span class="time">2/18/2021, 5:25:16 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/skills/Webpackæ¨¡å—å®ç°.html" class="prev">
        Webpack æ¨¡å—å®ç°
      </a></span> <span class="next"><a href="/blog/skills/æµè§ˆå™¨ç¼“å­˜.html">
        æµè§ˆå™¨ç¼“å­˜
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.b9d1aa2a.js" defer></script><script src="/blog/assets/js/3.8c44ca0e.js" defer></script><script src="/blog/assets/js/33.6665e618.js" defer></script><script src="/blog/assets/js/4.57980df9.js" defer></script>
  </body>
</html>

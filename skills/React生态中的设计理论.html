<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React 中的设计理论 | Lorain&#39;s Diary</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/base/hd-img.jpg">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/base/hd-img.jpg">
    <meta name="description" content="山中樗栎年年在 & 看尽西风木槿花">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/blog/assets/css/0.styles.4a9580f2.css" as="style"><link rel="preload" href="/blog/assets/js/app.9ee20128.js" as="script"><link rel="preload" href="/blog/assets/js/3.8c44ca0e.js" as="script"><link rel="preload" href="/blog/assets/js/31.75349241.js" as="script"><link rel="preload" href="/blog/assets/js/4.57980df9.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.930d1339.js"><link rel="prefetch" href="/blog/assets/js/11.cdeb8098.js"><link rel="prefetch" href="/blog/assets/js/12.c8cde42b.js"><link rel="prefetch" href="/blog/assets/js/13.a227fbb7.js"><link rel="prefetch" href="/blog/assets/js/14.6af4650a.js"><link rel="prefetch" href="/blog/assets/js/15.6eaa9661.js"><link rel="prefetch" href="/blog/assets/js/16.061f9c22.js"><link rel="prefetch" href="/blog/assets/js/17.45db52d8.js"><link rel="prefetch" href="/blog/assets/js/18.5f9597d2.js"><link rel="prefetch" href="/blog/assets/js/19.b4ea0dfc.js"><link rel="prefetch" href="/blog/assets/js/20.7f19d52d.js"><link rel="prefetch" href="/blog/assets/js/21.d8589558.js"><link rel="prefetch" href="/blog/assets/js/22.f566dc38.js"><link rel="prefetch" href="/blog/assets/js/23.b69d67c8.js"><link rel="prefetch" href="/blog/assets/js/24.643b50bd.js"><link rel="prefetch" href="/blog/assets/js/25.31cd7e03.js"><link rel="prefetch" href="/blog/assets/js/26.e8823c82.js"><link rel="prefetch" href="/blog/assets/js/27.a7430202.js"><link rel="prefetch" href="/blog/assets/js/28.d8ebaaa5.js"><link rel="prefetch" href="/blog/assets/js/29.4c8e906e.js"><link rel="prefetch" href="/blog/assets/js/30.ae43da30.js"><link rel="prefetch" href="/blog/assets/js/32.9b6fe64e.js"><link rel="prefetch" href="/blog/assets/js/33.4259a063.js"><link rel="prefetch" href="/blog/assets/js/34.4e487b39.js"><link rel="prefetch" href="/blog/assets/js/35.5844e768.js"><link rel="prefetch" href="/blog/assets/js/36.cd999bec.js"><link rel="prefetch" href="/blog/assets/js/37.3d9a9f24.js"><link rel="prefetch" href="/blog/assets/js/38.e4fa97e3.js"><link rel="prefetch" href="/blog/assets/js/39.8ba92439.js"><link rel="prefetch" href="/blog/assets/js/40.3e0a8f49.js"><link rel="prefetch" href="/blog/assets/js/41.55113ca5.js"><link rel="prefetch" href="/blog/assets/js/42.f350e725.js"><link rel="prefetch" href="/blog/assets/js/43.94613343.js"><link rel="prefetch" href="/blog/assets/js/44.ec233cc6.js"><link rel="prefetch" href="/blog/assets/js/45.555be71a.js"><link rel="prefetch" href="/blog/assets/js/46.03a26959.js"><link rel="prefetch" href="/blog/assets/js/47.b29d5306.js"><link rel="prefetch" href="/blog/assets/js/48.cd893ec3.js"><link rel="prefetch" href="/blog/assets/js/49.12210cfc.js"><link rel="prefetch" href="/blog/assets/js/5.5d055cab.js"><link rel="prefetch" href="/blog/assets/js/50.ddcb3929.js"><link rel="prefetch" href="/blog/assets/js/51.ec0a7d07.js"><link rel="prefetch" href="/blog/assets/js/52.73a630cf.js"><link rel="prefetch" href="/blog/assets/js/53.989d0b51.js"><link rel="prefetch" href="/blog/assets/js/6.5cf5829a.js"><link rel="prefetch" href="/blog/assets/js/7.46c43574.js"><link rel="prefetch" href="/blog/assets/js/8.97b71141.js"><link rel="prefetch" href="/blog/assets/js/9.5a3cc726.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.8f04fa7f.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.4a9580f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Lorain's Diary</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  📜前端技术
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  📊计算机基础
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  🍀其他记录
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐️Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/skills/" class="nav-link router-link-active">
  📜前端技术
</a></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  📊计算机基础
</a></div><div class="nav-item"><a href="/blog/life/" class="nav-link">
  🍀其他记录
</a></div><div class="nav-item"><a href="https://github.com/lorainwings" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐️Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS语言基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>H5及框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/skills/Base64.html" class="sidebar-link">Base64</a></li><li><a href="/blog/skills/图片分类.html" class="sidebar-link">图片分类</a></li><li><a href="/blog/skills/Rxjs初探.html" class="sidebar-link">Rxjs 初探</a></li><li><a href="/blog/skills/H5定位API.html" class="sidebar-link">H5 定位 API</a></li><li><a href="/blog/skills/初识Typescript.html" class="sidebar-link">初识 Typescript</a></li><li><a href="/blog/skills/Git 常用技巧.html" class="sidebar-link">Git 常用技巧</a></li><li><a href="/blog/skills/WebWorker实践小结.html" class="sidebar-link">WebWorker 实践小结</a></li><li><a href="/blog/skills/React生态中的设计理论.html" class="active sidebar-link">React 中的设计理论</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/skills/React生态中的设计理论.html#组件设计" class="sidebar-link">组件设计</a></li><li class="sidebar-sub-header"><a href="/blog/skills/React生态中的设计理论.html#状态管理" class="sidebar-link">状态管理</a></li><li class="sidebar-sub-header"><a href="/blog/skills/React生态中的设计理论.html#react-hooks" class="sidebar-link">React-Hooks</a></li><li class="sidebar-sub-header"><a href="/blog/skills/React生态中的设计理论.html#react-类组件的生命周期" class="sidebar-link">React 类组件的生命周期</a></li><li class="sidebar-sub-header"><a href="/blog/skills/React生态中的设计理论.html#组件的逻辑复用" class="sidebar-link">组件的逻辑复用</a></li><li class="sidebar-sub-header"><a href="/blog/skills/React生态中的设计理论.html#为什么要引入-redux" class="sidebar-link">为什么要引入 Redux</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全及性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务端入门</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-中的设计理论"><a href="#react-中的设计理论" class="header-anchor">#</a> React 中的设计理论</h1> <p>React 的生态万紫千红, 可谓是繁花似锦; 从这些框架及工具中衍生了各种的设计模式及理论知识, 本文就来盘点记录下相关的知识点</p> <h2 id="组件设计"><a href="#组件设计" class="header-anchor">#</a> 组件设计</h2> <p>如今各种前端框架均统一了组件化的思维, 面试中也会被问到, 如何设计一个组件(库), 笔者认为应该分为以下几个部分:</p> <ul><li><p>贯彻单一职责的原则</p></li> <li><p>组件的通信和封装</p></li> <li><p>组件的可组合性</p></li> <li><p>组件的可测试性</p></li> <li><p>组件的归类分类</p></li> <li><p>组件的命名规范</p></li></ul> <h3 id="单一职责原则"><a href="#单一职责原则" class="header-anchor">#</a> 单一职责原则</h3> <p>良好的设计中, 一个组件只干一件事情; 单一职责在组件中决定了组件如何拆分; 保持组件的单一职责将会非常重要，甚 至我们可以使用 HoC 强制组件的单一职责性。</p> <h3 id="组件的通信和封装"><a href="#组件的通信和封装" class="header-anchor">#</a> 组件的通信和封装</h3> <p>这块涉及到组件的参数设计、输入校验检查等， 也就是组件的健壮性；封装性决定了组件如何组织结构;</p> <h3 id="组件的可组合性"><a href="#组件的可组合性" class="header-anchor">#</a> 组件的可组合性</h3> <p>这块设计到整个组件如何拼接整个应用, 也就是组件的可复用性和扩展性;</p> <h3 id="组件的可测试性"><a href="#组件的可测试性" class="header-anchor">#</a> 组件的可测试性</h3> <p>良好的组件设计会让自动化测试变得异常简单, 这也涉及到良好的组件拆分</p> <h3 id="多组件的分类"><a href="#多组件的分类" class="header-anchor">#</a> 多组件的分类</h3> <p>如果需要设计一个组件库, 需要考虑的组件的拆分, 将组件分为纯组件和非纯(副作用)组件, 也就是对应<code>React</code>中的<code>Dumb</code>和<code>Smartß</code>组件</p> <h3 id="组件的命名规范"><a href="#组件的命名规范" class="header-anchor">#</a> 组件的命名规范</h3> <p>最后一步讲组件的命名, 主要是这块大多数人都觉得可有可无不重要, 其实良好的组件设计中, 组件名应该是能够见名知意的</p> <h2 id="状态管理"><a href="#状态管理" class="header-anchor">#</a> 状态管理</h2> <p>现在各种主流框架都会有各种的状态管理库, 而且框架中亦能自己管理状态; 所以问题就来了: <strong>到底什么样的状态用框架自带的状态来管理(局部状态),什么情况使用状态管理类库呢?</strong></p> <p>其实在历经这么多年的发展, 早已有最佳实践, 现在笔者来总结下:</p> <p>状态拆分原则:</p> <ol><li><p>公共通用数据放状态类库 (redux/vuex), 否则私有数据放框架局部 (react/vue) 中管理</p></li> <li><p>分散虚复用数据放状态类库, 频繁变动的原子级别数据放局部管理</p></li> <li><p>刷新需要持久化的放在 localstorage 中</p></li></ol> <h2 id="react-hooks"><a href="#react-hooks" class="header-anchor">#</a> React-Hooks</h2> <p>React-Hooks 解决了类组件什么历史问题:</p> <ul><li><p>状态难以复用(HOC 导致嵌套层级过多)</p></li> <li><p>复杂组件难以维护(逻辑分散且生命周期太多)</p></li> <li><p>this 指向问题</p></li></ul> <h2 id="react-类组件的生命周期"><a href="#react-类组件的生命周期" class="header-anchor">#</a> React 类组件的生命周期</h2> <p>此处贴一张自己画的图</p> <p><img src="/blog/skills/images/react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg" alt="React 的生命周期"></p> <h2 id="组件的逻辑复用"><a href="#组件的逻辑复用" class="header-anchor">#</a> 组件的逻辑复用</h2> <p>如今组件的逻辑复用, 主要有以下几种方式</p> <ul><li><p>Mixin</p></li> <li><p>HOC</p></li> <li><p>Render Props</p></li> <li><p>Hooks</p></li></ul> <h3 id="mixin-的优缺点"><a href="#mixin-的优缺点" class="header-anchor">#</a> Mixin 的优缺点</h3> <p>Mixin 作为早期数据复用的方式, 本质是将对象复制到另一个对象; 主要缺点是:</p> <p>相关依赖：mixin 有可能去依赖其他的 mixin，当我们修改其中一个的时候，可能会影响到其他的 mixin</p> <p>命名冲突：不同的人在写的时候很有可能会有命名冲突，比如像 handleChange 等类似常见的名字</p> <p>增加复杂性：当我们一个组件引入过多的 mixin 时，代码逻辑将会非常复杂，因为在不停的引入状态，和我们最初想的每个组件只做单一的功能背道而驰。</p> <h3 id="hoc"><a href="#hoc" class="header-anchor">#</a> HOC</h3> <p>HOC 优点是不会影响组件内部的状态,但是缺点也有:</p> <p>需要在原组件上进行包裹和嵌套，如果大量使用 HOC，将会产生非常多的嵌套，这让调试变得非常困难</p> <p>HOC 可以劫持 props，在不遵守约定的情况下也可能造成冲突</p> <h3 id="render-props"><a href="#render-props" class="header-anchor">#</a> Render Props</h3> <p><code>Render Props</code>灵活性非常高, 扩展性也很强;但是本身的缺点就是太容易造成“嵌套地狱”</p> <h3 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h3> <p>Hooks 可以算是终级解决方案了, 解决了上面的一系列问题</p> <h2 id="为什么要引入-redux"><a href="#为什么要引入-redux" class="header-anchor">#</a> 为什么要引入 Redux</h2> <p><code>Redux</code> 设计理念: 使用简单数组和对象来表示状态, 使用对象来描述状态的改变, 状态的改变逻辑必须是纯函数, 规范了状态管理的思想:</p> <ul><li><p>Redux 三个特点: 单一数据源, 所有数据都是只读的(只能通过 dispath('name',action)来触发), 处理 action 只是新生成对象而不修改原状态</p></li> <li><p>注定了 Redux 的数据可靠性, 可测试性, 无副作用, 数据的来源是清晰的, 数据的修改也能追溯</p></li> <li><p>而 set/get 的状态管理混乱, 无数据可靠性(不清楚 set 是否会覆盖其他的对象), 无法追溯数据来源(直接 get 太混乱, 导致复用性差), 不便于测试</p></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">4/4/2021, 1:55:57 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/skills/WebWorker实践小结.html" class="prev">
        WebWorker 实践小结
      </a></span> <span class="next"><a href="/blog/skills/Babel杂谈.html">
        Babel 杂谈
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.9ee20128.js" defer></script><script src="/blog/assets/js/3.8c44ca0e.js" defer></script><script src="/blog/assets/js/31.75349241.js" defer></script><script src="/blog/assets/js/4.57980df9.js" defer></script>
  </body>
</html>
